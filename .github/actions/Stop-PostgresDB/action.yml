name: PostgresServer-stop
description: stop postgres server on evenings and weekends
inputs:
  name:
    required: true
  subscription:
    required: true
  resource-group:
    required: true
  pass:
    required: true
  host:
    required: true

runs:
  using: "composite"
  steps:
    # stop db server
    - name: Stop Postgres DB
      id: stop-db
      shell: bash
      run: |
          sudo PGPASSWORD=${{ inputs.pass }} \
          PGSSLMODE=require \
          az login ${{ secrets.SERVICE_PRINCIPAL_CREDS }} \
          az postgres flexible-server stop --name ${{ inputs.name }} --resource-group ${{ inputs.resource-group }} --subscription ${{ inputs.subscription }}
