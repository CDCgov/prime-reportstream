- hl7Path: "/.MSH-3-1"
  fhirPath: "Bundle.entry.resource.as(Provenance).entity.where(role='source')"
  value: "{{resource.what.getResource().deviceName[0].name}}"
- hl7Path: "/.MSH-3-2"
  fhirPath: "Bundle.entry.resource.as(Provenance).entity.where(role='source')"
  value: "{{resource.what.getResource().identifier[0].value}}"
- hl7Path: "/.MSH-3-3"
  fhirPath: "Bundle.entry.resource.as(Provenance).entity.where(role='source')"
  value: "{{resource.what.getResource().identifier[0].system}}"
- hl7Path: "/.MSH-4-1"
  fhirPath: "Bundle.entry.resource.as(Provenance).first().agent.who"
  value: "{{resource.getResource().name}}"
- hl7Path: "/.MSH-4-2"
  fhirPath: "Bundle.entry.resource.as(Provenance).first().agent.who"
  value: "{{resource.getResource().identifier[0].value}}"
- hl7Path: "/.MSH-4-3"
  fhirPath: "Bundle.entry.resource.as(Provenance).first().agent.who"
  value: IS0
- hl7Path: "/.MSH-5-1"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).destination.name"
  value: "{{resource.value}}"
- hl7Path: "/.MSH-6-1"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).destination.endpoint"
  value: "{{resource.value}}"
- hl7Path: "/.MSH-7-1"
  fhirPath: "Bundle.entry.resource.as(Provenance)"
  value: "{{resource.recordedElement|datetime|formatDate(\"yyyyMMddHHmmss.SSSSZ\")}}"

- hl7Path: "/.SFT-1"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).source"
  value: "{{resource.name}}"
- hl7Path: "/.SFT-2"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).source"
  value: "{{resource.version}}"
- hl7Path: "/.SFT-3"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).source"
  value: "{{resource.software}}"
- hl7Path: "/.SFT-4"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).source.extension('http://reportstream.cdc.gov/binaryIdentifier')"
  value: "{{resource.value}}"
# how do we want to tell the system something is optional?
# - hl7Path: "/.SFT-6"
#   fhirPath: "Bundle.entry.resource.as(MessageHeader).source.extension('http://reportstream.cdc.gov/description')"
#   value: "{{resource.value}}"
- hl7Path: "/.SFT-7"
  fhirPath: "Bundle.entry.resource.as(MessageHeader).source.extension('http://reportstream.cdc.gov/installDate')"
  value: "{{resource.value}}"

- hl7Path: "/PATIENT_RESULT/PATIENT/PID-1"
  fhirPath: "Bundle.entry.resource.as(Patient)"
  value: "{{index + 1}}"
- hl7Path: "/PATIENT_RESULT/PATIENT/PID-3-1"
  fhirPath: "Bundle.entry.resource.as(Patient)"
  value: "{{resource.identifier[0].value}}"
- hl7Path: "/PATIENT_RESULT/ORDER_OBSERVATION/OBSERVATION({{index}})/OBX-1"
  fhirPath: "Bundle.entry.resource.as(Observation)"
  value: "{{index + 1}}"
- hl7Path: "/PATIENT_RESULT/ORDER_OBSERVATION/OBSERVATION({{index}})/OBX-2"
  fhirPath: "Bundle.entry.resource.as(Observation)"
  value: "CWE"
- hl7Path: "/PATIENT_RESULT/ORDER_OBSERVATION/OBSERVATION({{index}})/OBX-3-1"
  fhirPath: "Bundle.entry.resource.as(Observation)"
  value: "{{resource.code.coding[0].code}}"
- hl7Path: "/PATIENT_RESULT/ORDER_OBSERVATION/OBSERVATION({{index}})/OBX-3-2"
  fhirPath: "Bundle.entry.resource.as(Observation)"
  value: "{{resource.code.text}}"
- hl7Path: "/PATIENT_RESULT/ORDER_OBSERVATION/OBSERVATION({{index}})/OBX-3-3"
  fhirPath: "Bundle.entry.resource.as(Observation)"
  value: "{{resource.code.coding[0].system|hl7CodingSystem}}"