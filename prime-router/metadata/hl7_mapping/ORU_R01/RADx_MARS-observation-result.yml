constants:
  hl7ObservationPath: '/PATIENT_RESULT/ORDER_OBSERVATION(%{orderIndex})/OBSERVATION(%{resultIndex})'

elements:

#1	Set ID	Conditional		When OBX-5 (Set 3) is valued: "3"
#2	Symptomatic assessment value type	Conditional		When OBX-5 (Set 3) is valued: "CWE"
#3.1	Symptomatic assessment code	Conditional		When OBX-5 (Set 3) is valued: "95419-8"
#3.2	Symptomatic assessment code description	Conditional		When OBX-5 (Set 3) is valued: "Whether the patient has symptoms related to condition of interest"
#3.3	Symptomatic assessment code system	Conditional		When OBX-5 (Set 3) is valued: "LN"

  # OBX 3
  - name: radx-mars-symptomatic-assessment-value-type
    condition: '(%diagnostic.result.count() - 1) = 2 and %resource.value.exists()'
    value: ['"CWE"']
    hl7Spec: [ '%{hl7ObservationPath}/OBX-2' ]

  - name: radx-mars-symptomatic-code
    condition: '(%diagnostic.result.count() - 1) = 2 and %resource.value.exists()'
    value: ['"95419-8"']
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-1' ]

  - name: radx-mars-symptomatic-code-description
    condition: '(%diagnostic.result.count() - 1) = 2 and %resource.value.exists()'
    value: [ '"Whether the patient has symptoms related to condition of interest"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-2' ]

  - name: radx-mars-symptomatic-code-system
    condition: '(%diagnostic.result.count() - 1) = 2 and %resource.value.exists()'
    value: [ '"LN"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-3' ]

  - name: radx-mars-symptomatic-result-status
    condition: '(%diagnostic.result.count() - 1) = 2 and %resource.value.exists()'
    value: [ '"F"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-11' ]

  # OBX 4
#  1	Set ID	Conditional		When OBX-5 (Set 4) is valued: "4"
#  2	Illness onset date value type	Conditional		When OBX-5 (Set 4) is valued: "DT"
#  3.1	Illness onset date code	Conditional		When OBX-5 (Set 4) is valued: "65222-2"
#  3.2	Illness onset date code description	Conditional		When OBX-5 (Set 4) is valued: "Date and time of symptom onset"
#  3.3	Illness onset date code system	Conditional		When OBX-5 (Set 4) is valued: "LN"
#  5	Illness onset date result	Conditional		When OBX-5 (Set 3) is valued “Y” and user enters valid date: { YYYYMMDDHHMMSS[ +/-ZZZZ ] }
#  11	Illness onset date result status	Conditional		When OBX-5 (Set 4) is valued: "F"

  - name: radx-mars-onset-value-type
    condition: '(%diagnostic.result.count() - 1) = 3 and %resource.value.exists()'
    value: [ '"65222-2"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-1' ]

  - name: radx-mars-onset-date-code
    condition: '(%diagnostic.result.count() - 1) = 3 and %resource.value.exists()'
    value: [ '"Date and time of symptom onset"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-2' ]

  - name: radx-mars-onset-date-description
    condition: '(%diagnostic.result.count() - 1) = 3 and %resource.value.exists()'
    value: [ '"LN"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-3-3' ]

  - name: radx-mars-symptomatic-result-status
    condition: '(%diagnostic.result.count() - 1) = 3 and Bundle.entry.resource.ofType(Observation)[2].value = "Y" and and %resource.value is dateTime'
    value: [ '"F"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-5' ]

  - name: radx-mars-onset-date-result
    condition: '(%diagnostic.result.count() - 1) = 3 and %resource.value.exists()'
    value: [ '"F"' ]
    hl7Spec: [ '%{hl7ObservationPath}/OBX-11' ]




