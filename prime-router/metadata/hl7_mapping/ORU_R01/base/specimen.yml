constants:
  hl7SpecimenFieldPath: /PATIENT_RESULT/ORDER_OBSERVATION(%{orderIndex})/SPECIMEN/SPM
elements:
  - value: [ '"1"' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-1' ]

  - resource: '%resource.identifier.where(type.empty())'
    condition: '%resource.exists()'
    constants:
      entityIdFieldPath: '%{hl7SpecimenFieldPath}-2-1'
    schema: datatype/ei-entity-identifier
    resourceIndex: entityIdIndex

  - resource: '%resource.identifier.where(type.coding.code = "FGN")'
    condition: '%resource.exists()'
    constants:
      entityIdFieldPath: '%{hl7SpecimenFieldPath}-2-2'
    schema: datatype/ei-entity-identifier
    resourceIndex: entityIdIndex

  - resource: '%resource.type'
    constants:
      cweFieldPath: '%{hl7SpecimenFieldPath}-4'
    schema: datatype/ce-coded-with-exceptions

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-5' ]

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-6' ]

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-7' ]

  - resource: '%resource.collection.bodySite'
    condition: '%resource.exists()'
    constants:
      cweFieldPath: '%{hl7SpecimenFieldPath}-8'
    schema: datatype/ce-coded-with-exceptions

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-9' ]

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-11' ]

  - value: [ '%resource.note.text' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-14' ]

  - condition: '%resource.collection.collected is dateTime'
    value: [ '%resource.collection.collected' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-17-1' ]

  - condition: '%resource.collection.collected is Period'
    value: [ '%resource.collection.collected.start' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-17-1' ]

  - condition: '%resource.collection.collected is Period'
    value: [ '%resource.collection.collected.end' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-17-2' ]

  - condition: '%resource.receivedTime is dateTime'
    value: [ '%resource.receivedTime' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-18' ]

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-21' ]

  - value: [ '""' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-24' ]

  - resource: '%resource.container.specimenQuantity'
    condition: '%resource.exists()'
    value: [ '%resource.value' ]
    hl7Spec: [ '%{hl7SpecimenFieldPath}-26' ]

  - resource: '%resource.container.type'
    constants:
      cweFieldPath: '%{hl7SpecimenFieldPath}-27'
    schema: datatype/ce-coded-with-exceptions