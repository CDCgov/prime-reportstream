constants:
  hl7PV1Field: /PATIENT_RESULT/PATIENT/VISIT/PV1
elements:
  - value: [ '"1"' ]
    hl7Spec: [ '%{hl7PV1Field}-1' ]

  - condition: '%resource.class.code.exists()'
    value: [ '%resource.class.code.getPatientClass()' ]
    hl7Spec: [ '%{hl7PV1Field}-2' ]

  - value: [ '%resource.location[0].location.resolve().extension(%`rsext-point-of-care`).value' ]
    hl7Spec: [ '%{hl7PV1Field}-3-1' ]

  - resource: '%resource.location[0].location.resolve().identifier.value[0]'
    value: [ '%resource.substring(0, %resource.indexOf(","))' ]
    hl7Spec: [ '%{hl7PV1Field}-3-2' ]

  - resource: '%resource.location[0].location.resolve().identifier.value[0]'
    condition: '%resource.indexOf(",") > -1'
    value: [ '%resource.substring(%resource.indexOf(",") + 1)' ]
    hl7Spec: [ '%{hl7PV1Field}-3-3' ]

  - value: [ '%resource.type.coding.code' ]
    hl7Spec: [ '%{hl7PV1Field}-4' ]

  - resource: '%resource.participant.where(type.coding.code = "ATND").where(type.coding.system = "http://terminology.hl7.org/CodeSystem/v3-ParticipationType").individual.resolve()'
    constants:
      hl7XCNField: '%{hl7PV1Field}-7'
    schema: datatype/xcn-contact
    resourceIndex: contactIndex

  - resource: '%resource.participant.where(type.coding.code = "REF").where(type.coding.system = "http://terminology.hl7.org/CodeSystem/v3-ParticipationType").individual.resolve()'
    constants:
      hl7XCNField: '%{hl7PV1Field}-8'
    schema: datatype/xcn-contact
    resourceIndex: contactIndex

  - resource: '%resource.participant.where(type.coding.code = "CON").where(type.coding.system = "http://terminology.hl7.org/CodeSystem/v3-ParticipationType").individual.resolve()'
    constants:
      hl7XCNField: '%{hl7PV1Field}-9'
    schema: datatype/xcn-contact
    resourceIndex: contactIndex

  - value: [ '%resource.serviceType.coding.code' ]
    hl7Spec: [ '%{hl7PV1Field}-10' ]

  - value: [ '%resource.hospitalization.admitSource.coding.code' ]
    hl7Spec: [ '%{hl7PV1Field}-14' ]

  - resource: '%resource.participant.where(type.coding.code = "ADM").where(type.coding.system = "http://terminology.hl7.org/CodeSystem/v3-ParticipationType").individual.resolve()'
    constants:
      hl7XCNField: '%{hl7PV1Field}-17'
    schema: datatype/xcn-contact
    resourceIndex: contactIndex

  - value: [ '%resource.extension(%`rsext-patient-type`).value' ]
    hl7Spec: [ '%{hl7PV1Field}-18' ]

  - value: [ '%resource.extension(%`rsext-financial-class`).value' ]
    hl7Spec: [ '%{hl7PV1Field}-20' ]

  - value: [ '%resource.hospitalization.dischargeDisposition.coding.code' ]
    hl7Spec: [ '%{hl7PV1Field}-36' ]

  - value: [ '%resource.extension(%`rsext-servicing-facility`).value' ]
    hl7Spec: [ '%{hl7PV1Field}-39' ]

  - value: [ '%resource.extension(%`rsext-account-status`).value' ]
    hl7Spec: [ '%{hl7PV1Field}-41' ]

  - value: [ '%resource.period.start' ]
    hl7Spec: [ '%{hl7PV1Field}-44' ]

  - value: [ '%resource.period.end' ]
    hl7Spec: [ '%{hl7PV1Field}-45' ]