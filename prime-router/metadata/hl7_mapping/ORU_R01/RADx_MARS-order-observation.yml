constants:
  hl7Order: '/PATIENT_RESULT/ORDER_OBSERVATION(%{orderIndex})'
  service: 'Bundle.entry.resource.ofType(DiagnosticReport)[%orderIndex].basedOn.resolve()'
elements:

  - name: radx-mars-order-segment
    condition: '%service.extension(%`rsext-order-control`).exists()'
    schema: RADx_MARS-order

  - name: radx-mars-observation-request
    schema: RADx_MARS-observation-request


  # code.coding.code in ('85478-6'
  - name: ca-observation-result
    resource: '%resource.result.where(code.coding = "97099-6") | %resource.result.where(code.coding != "97099-6") | %service.supportingInfo.resolve()'
    schema: ca-observation-result
    resourceIndex: resultIndex