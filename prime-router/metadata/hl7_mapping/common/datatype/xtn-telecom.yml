constants:
  hl7TelecomPath: '%{hl7TelecomField}(%{telecomIndex})'

#TODO: Need to look for a way to set use code to ORN when home and cell phone is passed
elements:
  - name: xtn-use-code
    condition: '%resource.extension(%`rsext-telecom-use-code`).exists().not'
    value: [ '%resource.use' ]
    hl7Spec: [ '%{hl7TelecomPath}-2' ]
    valueSet:
      values:
        home: PRN
        work: WPN
        mobile: PRS
        temp: ORN

  - name: xtn-use-code-from-system
    condition: '%resource.system = "pager" and %resource.use.exists().not() and %resource.extension(%`rsext-telecom-use-code`).exists().not'
    value: [ '"BPN"' ]
    hl7Spec: [ '%{hl7TelecomPath}-2' ]

  - name: xtn-use-code-from-system
    condition: '%resource.system = "email" and %resource.use.exists().not() and %resource.extension(%`rsext-telecom-use-code`).exists().not'
    value: [ '"NET"' ]
    hl7Spec: [ '%{hl7TelecomPath}-2' ]

  - name: xtn-telecom-use-code-from-extension
    condition: '%resource.extension(%`rsext-telecom-use-code`).exists()'
    value: [ '%resource.extension(%`rsext-telecom-use-code`).value' ]
    hl7Spec: [ '%{hl7TelecomPath}-2' ]

  - name: xtn-system
    condition: '%resource.use.exists().not() or  %resource.use != "mobile"'
    value: [ '%resource.system' ]
    hl7Spec: [ '%{hl7TelecomPath}-3' ]
    valueSet:
      values:
        phone: PH
        pager: BP
        email: Internet
        fax: FX

  - name: xtn-system-from-use
    condition: '%resource.use.exists() and %resource.use = "mobile"'
    value: [ '"CP"' ]
    hl7Spec: [ '%{hl7TelecomPath}-3' ]

  - name: xtn-email
    condition: '%resource.system = "email" and %resource.extension(%`rsext-communication-address`).exists().not()'
    value: [ '%resource.value' ]
    hl7Spec: [ '%{hl7TelecomPath}-4' ]

  - name: xtn-communication-address
    condition: '%resource.extension(%`rsext-communication-address`).exists()'
    value: [ '%resource.extension(%`rsext-communication-address`).value' ]
    hl7Spec: [ '%{hl7TelecomPath}-4' ]

  - name: xtn-country-code
    condition: '%resource.value.exists() and %resource.extension(%`ext-contactpoint-country`).exists().not'
    value: [ '%resource.value.getPhoneNumberCountryCode()' ]
    hl7Spec: [ '%{hl7TelecomPath}-5' ]

  - name: xtn-country-code-from-extension-contactpoint-country
    condition: '%resource.extension(%`ext-contactpoint-country`).exists()'
    value: [ '%resource.extension(%`ext-contactpoint-country`).value' ]
    hl7Spec: [ '%{hl7TelecomPath}-5' ]

  - name: xtn-area-code
    condition: '%resource.value.exists()'
    value: [ '%resource.value.getPhoneNumberAreaCode()' ]
    hl7Spec: [ '%{hl7TelecomPath}-6' ]

  # RADx MARS format wants this value to be <deidentified>, but Hapi library does not allow that, so setting it to empty
  - name: xtn-area-code-deidentified
    condition: '%resource.value.exists() and %deidentifiedValue.empty().not()'
    value: [ '""' ]
    hl7Spec: [ '%{hl7TelecomPath}-6' ]

  - name: xtn-local-number
    condition: '%resource.value.exists()'
    value: [ '%resource.value.getPhoneNumberLocalNumber()' ]
    hl7Spec: [ '%{hl7TelecomPath}-7' ]

  # RADx MARS format wants this value to be <deidentified>, but Hapi library does not allow that, so setting it to empty
  - name: xtn-local-number-deidentified
    condition: '%resource.value.exists() and %deidentifiedValue.empty().not()'
    value: [ '""' ]
    hl7Spec: [ '%{hl7TelecomPath}-7' ]

  - name: xtn-extension
    condition: '%resource.value.exists() and %resource.value.hasPhoneNumberExtension()'
    value: [ '%resource.value.getPhoneNumberExtension()' ]
    hl7Spec: [ '%{hl7TelecomPath}-8' ]

  - name: xtn-text
    condition: '%resource.extension(%`rsext-text`).exists()'
    value: [ '%resource.extension(%`rsext-text`).value' ]
    hl7Spec: [ '%{hl7TelecomPath}-9' ]

  - name: xtn-unformatted-text
    condition: '%resource.value.exists() and %resource.system != "email" and %resource.extension(%`rsext-unformatted-telephone-number`).exists().not()'
    value: [ '%deidentifiedValue','%resource.value' ]
    hl7Spec: [ '%{hl7TelecomPath}-12' ]

  - name: xtn-unformatted-text
    condition: '%resource.extension(%`rsext-unformatted-telephone-number`).exists()'
    value: [ '%deidentifiedValue','%resource.extension(%`rsext-unformatted-telephone-number`).value' ]
    hl7Spec: [ '%{hl7TelecomPath}-12' ]
