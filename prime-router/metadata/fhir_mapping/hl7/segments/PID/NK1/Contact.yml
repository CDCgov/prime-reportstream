name:
  valueOf: datatypes/XPN/HumanName
  expressionType: resource
  specs: NK1.2

extension:
  expressionType: nested
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: v2Relationship
    valueCodeableConcept:
      valueOf: datatypes/CWE/CodeableConcept
      expressionType: resource
      specs: NK1.3

address:
  valueOf: datatypes/XAD/Address
  expressionType: resource
  specs: NK1.4

telecom:
  expressionType: nested
  expressions:
    - condition: $valueIn NOT_NULL
      valueOf: datatypes/XTN/ContactPoint
      generateList: true
      expressionType: resource
      specs: NK1.5
      vars:
        valueIn: NK1.5
      constants:
        hl7v2Name: "phone-number"
    - condition: $valueIn NOT_NULL
      valueOf: datatypes/XTN/ContactPoint
      generateList: true
      expressionType: resource
      specs: NK1.6
      vars:
        valueIn: NK1.6
      constants:
        useCode: work
        hl7v2Name: "business-phone-number"
    - condition: $valueIn NOT_NULL
      valueOf: datatypes/XTN/ContactPoint
      generateList: true
      expressionType: resource
      specs: NK1.40
      vars:
        valueIn: NK1.40
      constants:
        hl7v2Name: "next-of-kin-telecomm-info"
    - condition: $valueIn NOT_NULL
      valueOf: datatypes/XTN/ContactPoint
      generateList: true
      expressionType: resource
      specs: NK1.41
      vars:
        valueIn: NK1.41
      constants:
        hl7v2Name: "contact-person-telecomm-info"

relationship:
  valueOf: datatypes/CWE/CodeableConcept
  expressionType: resource
  specs: NK1.7

period:
  vars:
    startDate: NK1.8
    endDate: NK1.9
  condition: $startDate NOT_NULL || $endDate NOT_NULL
  expressionType: nested
  expressionsMap:
    start:
      valueOf: "GeneralUtils.dateTimeWithZoneId(startDate,ZONEID)"
      expressionType: JEXL
    _start:
      expressionType: nested
      condition: $startDate NOT_NULL
      expressionsMap:
        extension_1:
          generateList: true
          expressionType: nested
          expressionsMap:
            url:
              type: SYSTEM_URL
              value: hl7v2-date-time
            valueString:
              type: STRING
              valueOf: $startDate
              expressionType: HL7Spec
    end:
      valueOf: "GeneralUtils.dateTimeWithZoneId(endDate,ZONEID)"
      expressionType: JEXL
    _end:
      expressionType: nested
      condition: $endDate NOT_NULL
      expressionsMap:
        extension_1:
          generateList: true
          expressionType: nested
          expressionsMap:
            url:
              type: SYSTEM_URL
              value: hl7v2-date-time
            valueString:
              type: STRING
              valueOf: $endDate
              expressionType: HL7Spec
organization:
  condition: $XONOrganization NOT_NULL
  expressionType: reference
  valueOf: datatypes/XON/Organization
  specs: NK1.13
  vars:
    XONOrganization: NK1.13
    XPNHumanName: NK1.30
    XTNContactPoint: NK1.31
    XADAddress: NK1.32