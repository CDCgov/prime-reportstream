resourceType: MessageHeader

id:
  type: NAMED_UUID
  valueOf: MSH.10
  expressionType: HL7Spec

eventCoding:
  expressionType: resource
  valueOf: datatypes/MSG/Coding
  specs: MSH.9
  required: true

meta:
  expressionType: resource
  valueOf: datatypes/PT/Meta
  specs: MSH.11

source:
  valueOf: secondary/Source
  expressionType: resource

sender:
  condition: $msh4 NOT_NULL || $organizationCountry NOT_NULL
  valueOf: datatypes/HD/Organization
  expressionType: reference
  generateList: true
  specs: MSH.4
  vars:
    organizationCountry: MSH.17
    msh4: MSH.4

destination:
  valueOf: secondary/Destination
  generateList: true
  expressionType: resource

extension_1:
  expressionType: nested
  generateList: true
  specs: MSH.21
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: source-message-profile-id
    valueIdentifier:
      generateList: true
      valueOf: datatype/Identifier_SystemID
      expressionType: resource

responsible:
  vars:
    msh22: MSH.22
  condition: $msh22 NOT_NULL
  expressionType: reference
  valueOf: datatypes/XON/Organization
  specs: MSH.22

extension_2:
  condition: $msh15 NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    msh15: MSH.15
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: accept-acknowledgement-type
    valueIdentifier:
      valueOf: datatype/Identifier_SystemID
      expressionType: resource
      specs: MSH.15
      constants:
        system: "http://terminology.hl7.org/CodeSystem/v3-AcknowledgementCondition"
      vars:
        code: MSH.15

extension_3:
  condition: $msh16 NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    msh16: MSH.16
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: application-acknowledgement-type
    valueIdentifier:
      valueOf: datatype/Identifier_SystemID
      expressionType: resource
      specs: MSH.16
      constants:
        system: "http://terminology.hl7.org/CodeSystem/v3-AcknowledgementCondition"
      vars:
        code: MSH.16

extension_4:
  condition: $msh2 NOT_NULL && $msh2 EQUALS_STRING ^~\&#
  generateList: true
  expressionType: nested
  vars:
    msh2: String, MSH.2
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: encoding-characters
    valueString:
      type: STRING
      valueOf: MSH.2
      expressionType: HL7Spec

extension_5-character-set:
  condition: $msh18 NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    msh18: String, MSH.18
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: character-set
    valueString:
      type: STRING
      valueOf: MSH.18
      expressionType: HL7Spec
