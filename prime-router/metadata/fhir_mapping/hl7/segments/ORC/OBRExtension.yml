url:
  type: SYSTEM_URL
  value: obr-observation-request

extension:
  generateList: true
  expressionType: nested
  expressions:
    - expressionType: nested
      vars:
        obr2: STRING_ALL, OBR.2
        orc2: STRING_ALL, ORC.2
      condition: $orc2 NOT_NULL && $obr2 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-2-placer-order-number
        valueIdentifier:
          valueOf: datatypes/EI/Identifier
          expressionType: resource
          specs: OBR.2
    - expressionType: nested
      vars:
        obr3: STRING_ALL, OBR.3
        orc3: STRING_ALL, ORC.3
      condition: $orc3 NOT_NULL && $obr3 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-3-filler-order-number
        valueIdentifier:
          valueOf: datatypes/EI/Identifier
          expressionType: resource
          specs: OBR.3
    - expressionType: nested
      vars:
        obr10: STRING_ALL, OBR.10
      condition: $obr10 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-10-collector-identifier
        valueReference:
          expressionType: reference
          valueOf: datatypes/XCN/Practitioner
          specs: OBR.10
    - expressionType: nested
      vars:
        obr11: STRING, OBR.11
      condition: $obr11 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-11-specimen-action-code
        valueString:
          type: STRING
          expressionType: HL7Spec
          valueOf: OBR.11
    - expressionType: nested
      vars:
        obr12: STRING_ALL, OBR.12
      condition: $obr12 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-12-danger-code
        valueCodeableConcept:
          expressionType: resource
          valueOf: datatypes/CWE/CodeableConcept
          specs: OBR.12
    - expressionType: nested
      vars:
        obr13: STRING_ALL, OBR.13
      condition: $obr13 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-13-clinical-information
        valueString:
          expressionType: HL7Spec
          type: STRING
          valueOf: OBR.13
    - expressionType: nested
      vars:
        orc12: STRING_ALL, ORC.12
        obr16: STRING_ALL, OBR.16
      condition: $orc12 NOT_NULL && $obr16 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-16-ordering-provider
        valueReference:
          expressionType: reference
          valueOf: datatypes/XCN/Practitioner
          specs: OBR.16
    - condition: $orc14 NOT_NULL && $obr17 NOT_NULL
      vars:
        orc14: STRING_ALL, ORC.14
        obr17: STRING_ALL, OBR.17
      expressionType: nested
      specs: OBR.17 *
      generateList: true
      expressionsMap:
        url:
          type: SYSTEM_URL
          value: callback-number
        valueContactPoint:
          valueOf: datatypes/XTN/ContactPoint
          expressionType: resource
          constants:
            hl7v2Field: "OBR.17"
    - expressionType: nested
      vars:
        obr18: OBR.18
      condition: $obr18 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-18-placer-field-1
        valueString:
          type: STRING
          valueOf: OBR.18
          expressionType: HL7Spec
    - expressionType: nested
      vars:
        obr19: OBR.19
      condition: $obr19 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-19-placer-field-2
        valueString:
          type: STRING
          valueOf: OBR.19
          expressionType: HL7Spec
    - expressionType: nested
      vars:
        obr20: OBR.20
      condition: $obr20 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-20-filler-field-1
        valueString:
          type: STRING
          valueOf: OBR.20
          expressionType: HL7Spec
    - expressionType: nested
      vars:
        obr21: OBR.21
      condition: $obr21 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-21-filler-field-2
        valueString:
          type: STRING
          valueOf: OBR.21
          expressionType: HL7Spec
    - expressionType: nested
      vars:
        obr22: OBR.22
      condition: $obr22 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-22-results-rpt-status-change-datetime
        valueString:
          type: STRING
          expressionType: HL7Spec
          valueOf: OBR.22
    - expressionType: resource
      valueOf: datatypes/MOC/Extension
      vars:
        obr23: STRING_ALL, OBR.23
      condition: $obr23 NOT_NULL
      specs: OBR.23
      constants:
        mocExtensionName: obr-23-charge-to-practice
    - expressionType: nested
      vars:
        obr24: OBR.24
      condition: $obr24 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-24-diagnostic-serv-sect-id
        valueId:
          type: STRING
          expressionType: HL7Spec
          valueOf: OBR.24
    - expressionType: resource
      vars:
        obr26: STRING_ALL, OBR.26
      condition: $obr26 NOT_NULL
      valueOf: datatypes/PRL/Extension
      specs: OBR.26
      constants:
        prlExtensionName: obr-26-parent-result
    - expressionType: nested
      vars:
        obr28: STRING_ALL, OBR.28
      condition: $obr28 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-28-result-copies-to
        valueReference:
          expressionType: reference
          valueOf: datatypes/XCN/Practitioner
          specs: OBR.28
    - expressionType: nested
      vars:
        obr29: STRING_ALL, OBR.29
      condition: $obr29 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-29-parent-order
        valueIdentifier:
          valueOf: datatypes/EIP/Identifier-PlacerAssignedIdentifier
          expressionType: resource
          specs: OBR.29
          constants:
            backupExtension: "filler-assigned-identifier"
    - expressionType: nested
      vars:
        obr33: STRING_ALL, OBR.33
      condition: $obr33 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-33-assistant-result-interpreter
        valueReference:
          valueOf: datatypes/NDL/PractitionerRole
          expressionType: reference
          specs: OBR.33
    - expressionType: nested
      vars:
        obr36: STRING, OBR.36
      condition: $obr36 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-36-scheduled-datetime
        valueString:
          type: STRING
          expressionType: HL7Spec
          valueOf: OBR.36
    - expressionType: nested
      vars:
        obr39: STRING_ALL, OBR.39
      condition: $obr39 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-39-collectors-comment
        valueCodeableConcept:
          valueOf: datatypes/CWE/CodeableConcept
          expressionType: resource
          specs: OBR.39
    - expressionType: nested
      vars:
        obr44: STRING_ALL, OBR.44
      condition: $obr44 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-44-procedure-code
        valueCodeableConcept:
          valueOf: datatypes/CNE/CodeableConcept
          expressionType: resource
          specs: OBR.44
    - expressionType: nested
      vars:
        obr45: STRING_ALL, OBR.45
      condition: $obr45 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-45-procedure-code-modifier
        valueCodeableConcept:
          valueOf: datatypes/CNE/CodeableConcept
          expressionType: resource
          specs: OBR.45
    - expressionType: nested
      vars:
        obr48: STRING_ALL, OBR.48
      condition: $obr48 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-48-medically-necessary-duplicate-procedure
        valueCodeableConcept:
          valueOf: datatypes/CWE/CodeableConcept
          expressionType: resource
          specs: OBR.48
    - expressionType: nested
      vars:
        obr49: STRING_ALL, OBR.49
      condition: $obr49 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-49-result-handling
        valueString:
          type: STRING
          expressionType: HL7Spec
          valueOf: OBR.49
    - expressionType: nested
      vars:
        obr50: STRING_ALL, OBR.50
      condition: $obr50 NOT_NULL
      expressionsMap:
        url:
          type: STRING
          value: obr-50-parent-universal-service-identifier
        valueCodeableConcept:
          expressionType: resource
          valueOf: datatypes/CWE/CodeableConcept
          specs: OBR.50
    - condition: $orc33 NOT_NULL && $obr53 NOT_NULL
      vars:
        orc33: STRING_ALL, ORC.33
        obr53: STRING_ALL, OBR.53
      expressionType: nested
      expressionsMap:
        url:
          type: STRING
          value: obr-53-alternate-placer-order-number
        valueIdentifier:
          valueOf: datatypes/CX/Identifier
          expressionType: resource
          specs: OBR.53
          constants:
            CXIdentifierField: OBR.53