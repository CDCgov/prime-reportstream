value_1:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $localNum NULL && $unformattedTelNum NULL && $telNum NOT_NULL
  valueOf: $telNum
  vars:
    telNum: String, XTN.1
    telEquipType: String, XTN.3
    localNum: String, XTN.7
    unformattedTelNum: String, XTN.12

value_2:
  condition: $telEquipType NULL && $localNum NULL && $unformattedTelNum NULL && $telNum NOT_NULL
  valueOf: $telNum
  vars:
    telNum: String, XTN.1
    telEquipType: String, XTN.3
    localNum: String, XTN.7
    unformattedTelNum: String, XTN.12

value_3:
  condition: $telEquipType EQUALS Internet || $telEquipType EQUALS X.400
  valueOf: $commAddress
  vars:
    telEquipType: String, XTN.3
    commAddress: String, XTN.4

value_4:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $unformattedTelNum NOT_NULL
  valueOf: unformattedTelNum
  vars:
    telEquipType: String, XTN.3
    unformattedTelNum: String, XTN.12

value_5:
  condition: $telEquipType NULL && $unformattedTelNum NOT_NULL
  valueOf: unformattedTelNum
  vars:
    telEquipType: String, XTN.3
    unformattedTelNum: String, XTN.12

#mapping from HL7 Concept Map: TelecomUseCode
#https://docs.google.com/spreadsheets/d/1EE3a5UIGXLi8wMDr49fWTEVx8QS2GFqYgitE3vLOQTQ/edit#gid=0
use_1:
  condition: $useCode EQUALS PRN && $hl7Use NULL
  type: STRING
  value: "home"
  vars:
    useCode: String, XTN.2

use_2:
  condition: $useCode EQUALS WPN && $hl7Use NULL
  type: STRING
  value: "work"
  vars:
    useCode: String, XTN.2

use_3:
  condition: $useCode EQUALS BPN && $hl7Use NULL
  type: STRING
  value: "mobile"
  vars:
    useCode: String, XTN.2

use_4:
  condition: $hl7Use NOT_NULL
  type: STRING
  value: $hl7Use

#mapping from HL7 Concept Map: TelecomEquipmentType
#https://docs.google.com/spreadsheets/d/1FhoR5oxEWdHmpR5S0_wYPstdy1lwv7rL-JWJu_DE_Vs/edit#gid=0
system_1:
  condition: $equipType EQUALS PH
  type: STRING
  valueOf: "phone"
  vars:
    equipType: String, XTN.3

system_2:
  condition: $equipType EQUALS FX
  type: STRING
  valueOf: "fax"
  vars:
    equipType: String, XTN.3

system_3:
  condition: $equipType EQUALS Internet || $equipType EQUALS X.400
  type: STRING
  valueOf: "email"
  vars:
    equipType: String, XTN.3

system_4:
  condition: $equipType EQUALS BP
  type: STRING
  valueOf: "pager"
  vars:
    equipType: String, XTN.3

system_5:
  condition: $equipType EQUALS MD || $equipType EQUALS SAT || $equipType EQUALS TDD || $equipType EQUALS TTY
  type: STRING
  valueOf: "other"
  vars:
    equipType: String, XTN.3

system_6:
  condition: $telEquipType NULL && $commAddress NOT_NULL
  valueOf: "email"
  vars:
    telEquipType: String, XTN.3
    commAddress: String, XTN.4

system_7:
  condition: $telEquipType NULL && $commAddress NULL
  expressionType: nested
  vars:
    telEquipType: String, XTN.3
    commAddress: String, XTN.4
  expressionsMap:
    extension:
      generateList: true
      expressionType: nested
      expressionsMap:
        url:
          type: SYSTEM_URL
          value: "data-absent-reason"
        valueCode:
          value: unknown

extension_xtn3-telecom-equipment-type:
  condition: $equipType NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    equipType: String, XTN.3
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn3-telecom-equipment-type
    valueString:
      value: $equipType


extension_xtn5-country-code:
  condition: $countryCode NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    countryCode: String, XTN.5
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: contactpoint-country
    valueString:
      value: $countryCode

extension_xtn6-area-code:
  condition: $areaCode NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    areaCode: String, XTN.6
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: contactpoint-area
    valueString:
      value: $areaCode

extension_xtn7-contactpoint-local_1:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $contactPointLocal NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    telEquipType: String, XTN.3
    contactPointLocal: String, XTN.7
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: contactpoint-local
    valueString:
      value: $contactPointLocal

extension_xtn7-contactpoint-local_2:
  condition: $telEquipType NULL && $contactPointLocal NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    telEquipType: String, XTN.3
    contactPointLocal: String, XTN.7
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: contactpoint-local
    valueString:
      value: $contactPointLocal

extension_xtn7-local-number:
  condition: $localNum NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    localNum: String, XTN.7
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn7-local-number
    valueString:
      value: $localNum

extension_xtn8-phone-extension:
  condition: $numExt NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    numExt: String, XTN.8
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: contactpoint-extension
    valueString:
      value: $numExt

extension_xtn9-any-text:
  condition: $anyText NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    anyText: String, XTN.9
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn9-any-text
    valueString:
      type: STRING
      valueOf: $anyText

extension_xtn2-telecom-use-code:
  condition: $useCode NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    useCode: String, XTN.2
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn2-telecom-use-code
    valueString:
      value: $useCode

extension_hl7-use:
  condition: $hl7Use NOT_NULL
  generateList: true
  expressionType: nested
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: hl7-use
    valueString:
      value: $hl7Use

extension_telephone-number:
  condition: $telNum NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    telNum: String, XTN.1
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn1-telephone-number
    valueString:
      value: $telNum

extension_xtn4-communication-address:
  condition: $commAddress NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    commAddress: String, XTN.4
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn4-communication-address
    valueString:
      value: $commAddress

extension_xtn12-unformatted-telephone-number:
  condition: $unformattedTelNum NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    unformattedTelNum: String, XTN.12
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: xtn12-unformatted-telephone-number
    valueString:
      value: $unformattedTelNum

period:
  generateList: true
  expressionType: nested
  vars:
    start: XTN.13
    end: XTN.14
  expressionsMap:
    start:
      condition: $start NOT_NULL
      type: STRING
      valueOf: "GeneralUtils.dateTimeWithZoneId(start,ZONEID)"
      expressionType: JEXL
    end:
      condition: $end NOT_NULL
      type: STRING
      valueOf: "GeneralUtils.dateTimeWithZoneId(end,ZONEID)"
      expressionType: JEXL

rank:
  type: POSITIVEINT
  valueOf: XTN.18
  expressionType: HL7Spec

extension_hl7v2Name:
  generateList: true
  expressionType: nested
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: hl7v2Name
    valueString:
      type: STRING
      valueOf: $hl7v2Name