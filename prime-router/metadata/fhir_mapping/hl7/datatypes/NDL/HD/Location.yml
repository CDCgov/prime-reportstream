resourceType: Location

id:
  type: STRING
  valueOf: "GeneralUtils.generateResourceId()"
  expressionType: JEXL

identifier_1:
  condition: $hd1 NOT_NULL
  vars:
    hd1: String, HD.1
  expressionType: nested
  generateList: true
  expressionsMap:
    value_1:
      type: STRING
      expressionType: HL7Spec
      valueOf: HD.1
    extension_1-namespaceId:
      generateList: true
      expressionType: nested
      expressionsMap:
        url:
          type: SYSTEM_URL
          value: identifier-namespace-id
        valueBoolean:
          valueOf: "true"

identifier_2:
  condition: $hd2 NOT_NULL
  expressionType: nested
  generateList: true
  vars:
    hd2: String, HD.2
  expressionsMap:
    value:
      type: STRING
      expressionType: HL7Spec
      valueOf: HD.2
    type:
      valueOf: datatype/CodeableConcept_var
      generateList: true
      expressionType: resource
      vars:
        code: HD.3
      constants:
        system: "http://terminology.hl7.org/CodeSystem/v2-0301"
    extension_1-universalId:
      generateList: true
      expressionType: nested
      expressionsMap:
        url:
          type: SYSTEM_URL
          value: identifier-universal-id
        valueBoolean:
          valueOf: "true"

status:
  valueOf: $ndlLocationStatus
  type: STRING
  expressionType: HL7Spec

mode:
  value: 'instance'
  type: STRING

physicalType:
  expressionType: nested
  expressionsMap:
    coding:
      expressionType: nested
      generateList: true
      expressions:
        - expressionType: nested
          expressionsMap:
            code:
              condition: $physicalTypeCode NOT_EQUALS poc
              type: STRING
              valueOf: $physicalTypeCode
            _code:
              condition: $physicalTypeCode EQUALS poc
              expressionType: nested
              expressionsMap:
                extension:
                  generateList: true
                  expressionType: nested
                  expressionsMap:
                    url:
                      type: SYSTEM_URL
                      value: location-physical-type-poc
                    valueString:
                      value: "poc"
            system:
              type: STRING
              value: "http://terminology.hl7.org/CodeSystem/location-physical-type"

partOf:
  valueOf: datatype/Reference
  expressionType: resource
  specs: $Location
  condition: $refLocation EQUALS $partOfId
  vars:
    refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier.value[0].value","String")


