resourceType: PractitionerRole

id:
  type: STRING
  valueOf: "GeneralUtils.generateResourceId()"
  expressionType: JEXL

name:
  valueOf: datatypes/CNN/Practitioner
  expressionType: reference
  specs: NDL.1

period:
  expressionType: nested
  expressionsMap:
    start:
      valueOf: "GeneralUtils.dateTimeWithZoneId(dateTimeIn,ZONEID)"
      expressionType: JEXL
      vars:
        dateTimeIn: NDL.2
      type: STRING
    end:
      valueOf: "GeneralUtils.dateTimeWithZoneId(dateTimeIn,ZONEID)"
      expressionType: JEXL
      vars:
        dateTimeIn: NDL.3
      type: STRING

location:
  generateList: true
  expressionType: nested
  expressions:
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.7
      vars:
        status: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "si"
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.10
      vars:
        refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier[0].value","String")
        partOfId: NLD.7.1
        ndlLocationStatus: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "bu"
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.4
      vars:
        refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier[0].value","String")
        partOfId: NLD.10
        ndlLocationStatus: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "poc" # TODO this should be an extension
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.11
      vars:
        refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier[0].value","String")
        partOfId: NLD.4
        ndlLocationStatus: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "lvl"
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.5
      vars:
        refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier[0].value","String")
        partOfId: NLD.4
        $ndlLocationStatus: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "ro"
    - valueOf: datatypes/NDL/Location
      expressionType: reference
      specs: NDL.6
      vars:
        refLocation: $BASE_VALUE, GeneralUtils.extractAttribute(refLocation,"$.identifier[0].value","String")
        partOfId: NLD.5
        ndlLocationStatus: NDL.8
      constants:
        mode: "instance"
        physicalTypeCode: "bd"


extension:
  generateList: true
  expressionType: nested
  expressions:
    - expressionType: nested
      expressionsMap:
        url:
          type: SYSTEM_URL
          value: event-performerFunction
        valueCodeableConcept:
          valueOf: datatype/CodeableConcept_var
          expressionType: resource
          vars:
            code: $performerParticipationType
          constants:
            system: "http://terminology.hl7.org/CodeSystem/v3-ParticipationType"