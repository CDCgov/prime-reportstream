value_1:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $localNum NULL && $unformattedTelNum NULL && $telNum NOT_NULL
  valueOf: $telNum
  vars:
    telNum: String, XTN.1
    telEquipType: String, XTN.3
    localNum: String, XTN.7
    unformattedTelNum: String, XTN.12

value_2:
  condition: $telEquipType NULL && $localNum NULL && $unformattedTelNum NULL && $telNum NOT_NULL
  valueOf: $telNum
  vars:
    telNum: String, XTN.1
    telEquipType: String, XTN.3
    localNum: String, XTN.7
    unformattedTelNum: String, XTN.12

value_3:
  condition: $telEquipType EQUALS Internet || $telEquipType EQUALS X.400
  valueOf: XTN.4
  expressionType: HL7Spec
  vars:
    telEquipType: String, XTN.3

value_4:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $unformattedTelNum NOT_NULL
  valueOf: XTN.12
  vars:
    telEquipType: String, XTN.3
    unformattedTelNum: String, XTN.12

use:
  condition: $telUseCode NOT_NULL
  valueOf: XTN.2
  vars:
    telUseCode: String, XTN.2

system_1:
  condition: $equipType EQUALS PH
  type: STRING
  valueOf: "phone"
  vars:
    equipType: String, XTN.3

system_2:
  condition: $equipType EQUALS FX
  type: STRING
  valueOf: "fax"
  vars:
    equipType: String, XTN.3

system_3:
  condition: $equipType EQUALS Internet || $equipType EQUALS X.400
  type: STRING
  valueOf: "email"
  vars:
    equipType: String, XTN.3

system_4:
  condition: $equipType EQUALS BP
  type: STRING
  valueOf: "pager"
  vars:
    equipType: String, XTN.3

system_5:
  condition: $equipType EQUALS MD || $equipType EQUALS SAT || $equipType EQUALS TDD || $equipType EQUALS TTY
  type: STRING
  valueOf: "other"
  vars:
    equipType: String, XTN.3

system_6:
  condition: $telEquipType NULL && $commAddress NOT_NULL
  valueOf: "email"
  vars:
    telEquipType: String, XTN.3
    commAddress: String, XTN.4

system_7:
  condition: $telEquipType NULL && $commAddress NOT_NULL
  valueOf: extension/DataTypeReason
  expressionType: resource
  vars:
    telEquipType: String, XTN.3
    commAddress: String, XTN.4
    reason: "unknown"

extension_1-telecom-equipment-type:
  condition: $equipType NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    equipType: String, XTN.3
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "telecom-equipment-type"
    valueString:
      value: $equipType


extension_2-country-code:
  condition: $countryCode NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    countryCode: String, XTN.5
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "contactpoint-country"
    valueString:
      value: $countryCode

extension_3-area-code:
  condition: $areaCode NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    areaCode: String, XTN.6
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "contactpoint-area"
    valueString:
      value: $areaCode

extension_4-local-number:
  condition: $telEquipType NOT_EQUALS Internet && $telEquipType NOT_EQUALS X.400 && $localNum NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    telEquipType: String, XTN.3
    localNum: String, XTN.7
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "contactpoint-local"
    valueString:
      value: $localNum

extension_5-phone-extension:
  condition: $numExt NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    numExt: String, XTN.8
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "contactpoint-extension"
    valueString:
      value: $numExt

extension_6-any-text:
  condition: $anyText NOT_NULL
  generateList: true
  expressionType: nested
  vars:
    anyText: String, XTN.9
  expressionsMap:
    url:
      type: SYSTEM_URL
      value: "text"
    valueString:
      type: STRING
      valueOf: $anyText

period:
  valueOf: datatype/Period
  expressionType: resource
  vars:
    start: $start
    end: $end

rank:
  type: POSITIVEINT
  valueOf: XTN.18
  expressionType: HL7Spec