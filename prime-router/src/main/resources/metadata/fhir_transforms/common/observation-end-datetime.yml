# $schema: ../../../../../../metadata/json_schema/fhir/fhir-to-fhir-transform.json

constants:
  rsext: '"https://reportstream.cdc.gov/fhir/StructureDefinition/"'

elements:
  - name: observation-start-datetime
    resource: 'Bundle.entry.resource.ofType(DiagnosticReport)'
    condition: '%resource.effective.is(dateTime)'
    bundleProperty: '%resource.effectivePeriod.start'
    value: [ '%resource.effective.extension(%`rsext-hl7v2-date-time`).value' ]

  - name: observation-start-datetime2
    resource: 'Bundle.entry.resource.ofType(DiagnosticReport).effective'
    bundleProperty: '%resource.start.extension("https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time").value[x]'
    value: [ '%resource.start' ]




#  - name: observation-end-datetime
#    resource: 'Bundle.entry.resource.ofType(DiagnosticReport)'
#    bundleProperty: '%resource.effectivePeriod.end.extension(%`rsext-hl7v2-date-time`).value'
#    value: [ '%resource.effective.extension(%`rsext-hl7v2-date-time`).value' ]