# possible '%resource's:
# Bundle.entry.resource.ofType(Observation).where(focus.exists()).where(focus.resolve().id = Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).value = "SPM") | Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).exists().not()).id).performer.resolve().ofType(Organization).where(extension(%`rsext-hl7v2Field`).value.join(",").contains("OBX.25")).extension(%`rsext-xon-organization`)
# Bundle.entry.resource.ofType(Observation).where(focus.exists()).where(focus.resolve().id = Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).value = "SPM") | Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).exists().not()).id).performer.resolve().ofType(PractitionerRole).where(code.coding.code = "MDIR").organization.resolve().extension(%`rsext-xon-organization`)
# $schema: ./../../../../../../../metadata/json_schema/fhir/fhir-to-hl7-mapping.json

elements:

  - name: xon-3-id-number
    value: [ '%resource.extension("XON.3").value' ]
    hl7Spec: [ '%{hl7XONField}-3' ]

  - name: xon-10-organization-identifier
    value: [ '%resource.extension("XON.10").value' ]
    hl7Spec: [ '%{hl7XONField}-10' ]