# possible '%resource's:
# OBX-5-1: Bundle.entry.resource.ofType(Observation).where(focus.exists()).where(focus.resolve().id = Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).value = "SPM") | Bundle.entry.resource.ofType(DiagnosticReport).where(subject.resolve().id = Bundle.entry.resource.ofType(Patient).id).specimen.resolve().where(extension(%`rsext-hl7v2Segment`).exists().not()).id).extension("https://hl7.org/fhir/R5/StructureDefinition/observation-value-attachment").value.extension(%`rsext-ed-attachment`).extension("ED.1")
# $schema: ./../../../../../../../metadata/json_schema/fhir/fhir-to-hl7-mapping.json

elements:

  - name: hd-extension-namespace-id
    value: [ '%resource.extension(%`rsext-namespace-id`).value' ]
    hl7Spec: [ '%{hl7HDField}-1' ]

  - name: hd-extension-universal-id
    value: [ '%resource.extension(%`rsext-universal-id`).value' ]
    hl7Spec: [ '%{hl7HDField}-2' ]

  - name: hd-extension-universal-id
    value: [ '%resource.extension(%`rsext-universal-id-type`).value' ]
    hl7Spec: [ '%{hl7HDField}-3' ]