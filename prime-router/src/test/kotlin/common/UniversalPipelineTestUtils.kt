package gov.cdc.prime.router.common

import assertk.assertThat
import assertk.assertions.hasSize
import assertk.assertions.isEqualTo
import gov.cdc.prime.router.ClientSource
import gov.cdc.prime.router.CustomerStatus
import gov.cdc.prime.router.DeepOrganization
import gov.cdc.prime.router.FileSettings
import gov.cdc.prime.router.MimeFormat
import gov.cdc.prime.router.Options
import gov.cdc.prime.router.Organization
import gov.cdc.prime.router.Receiver
import gov.cdc.prime.router.Report
import gov.cdc.prime.router.ReportStreamConditionFilter
import gov.cdc.prime.router.Topic
import gov.cdc.prime.router.UniversalPipelineSender
import gov.cdc.prime.router.azure.BlobAccess
import gov.cdc.prime.router.azure.DataAccessTransaction
import gov.cdc.prime.router.azure.Event
import gov.cdc.prime.router.azure.ProcessEvent
import gov.cdc.prime.router.azure.WorkflowEngine
import gov.cdc.prime.router.azure.db.Tables
import gov.cdc.prime.router.azure.db.enums.TaskAction
import gov.cdc.prime.router.azure.db.tables.ItemLineage
import gov.cdc.prime.router.azure.db.tables.ReportLineage
import gov.cdc.prime.router.azure.db.tables.pojos.Action
import gov.cdc.prime.router.azure.db.tables.pojos.ReportFile
import gov.cdc.prime.router.db.ReportStreamTestDatabaseContainer
import gov.cdc.prime.router.fhirengine.azure.FHIRFunctions
import gov.cdc.prime.router.history.db.ReportGraph
import gov.cdc.prime.router.metadata.LookupTable
import gov.cdc.prime.router.report.ReportService
import gov.cdc.prime.router.unittest.UnitTestUtils
import org.jooq.impl.DSL
import org.testcontainers.containers.GenericContainer
import java.time.OffsetDateTime

@Suppress("ktlint:standard:max-line-length")
const val validFHIRRecord1 =
    """{"resourceType":"Bundle","id":"1667861767830636000.7db38d22-b713-49fc-abfa-2edba9c12347","meta":{"lastUpdated":"2022-11-07T22:56:07.832+00:00"},"identifier":{"value":"1234d1d1-95fe-462c-8ac6-46728dba581c"},"type":"message","timestamp":"2021-08-03T13:15:11.015+00:00","entry":[{"fullUrl":"Observation/d683b42a-bf50-45e8-9fce-6c0531994f09","resource":{"resourceType":"Observation","id":"d683b42a-bf50-45e8-9fce-6c0531994f09","status":"final","code":{"coding":[{"system":"http://loinc.org","code":"80382-5"}],"text":"Flu A"},"subject":{"reference":"Patient/9473889b-b2b9-45ac-a8d8-191f27132912"},"performer":[{"reference":"Organization/1a0139b9-fc23-450b-9b6c-cd081e5cea9d"}],"valueCodeableConcept":{"coding":[{"system":"http://snomed.info/sct","code":"260373001","display":"Detected"}]},"interpretation":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0078","code":"A","display":"Abnormal"}]}],"method":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/testkit-name-id","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/equipment-uid","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}}],"coding":[{"display":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B*"}]},"specimen":{"reference":"Specimen/52a582e4-d389-42d0-b738-bee51cf5244d"},"device":{"reference":"Device/78dc4d98-2958-43a3-a445-76ceef8c0698"}}}]}"""
const val validFHIRRecord1Identifier = "1234d1d1-95fe-462c-8ac6-46728dba581c"

@Suppress("ktlint:standard:max-line-length")
const val conditionCodedValidFHIRRecord1 =
    """{"resourceType":"Bundle","id":"1667861767830636000.7db38d22-b713-49fc-abfa-2edba9c12347","meta":{"lastUpdated":"2022-11-07T22:56:07.832+00:00"},"identifier":{"value":"1234d1d1-95fe-462c-8ac6-46728dba581c"},"type":"message","timestamp":"2021-08-03T13:15:11.015+00:00","entry":[{"fullUrl":"Observation/d683b42a-bf50-45e8-9fce-6c0531994f09","resource":{"resourceType":"Observation","id":"d683b42a-bf50-45e8-9fce-6c0531994f09","status":"final","code":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/condition-code","valueCoding":{"system":"SNOMEDCT","code":"6142004","display":"Influenza (disorder)"}}],"system":"http://loinc.org","code":"80382-5"}],"text":"Flu A"},"subject":{"reference":"Patient/9473889b-b2b9-45ac-a8d8-191f27132912"},"performer":[{"reference":"Organization/1a0139b9-fc23-450b-9b6c-cd081e5cea9d"}],"valueCodeableConcept":{"coding":[{"system":"http://snomed.info/sct","code":"260373001","display":"Detected"}]},"interpretation":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0078","code":"A","display":"Abnormal"}]}],"method":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/testkit-name-id","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/equipment-uid","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}}],"coding":[{"display":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B*"}]},"specimen":{"reference":"Specimen/52a582e4-d389-42d0-b738-bee51cf5244d"},"device":{"reference":"Device/78dc4d98-2958-43a3-a445-76ceef8c0698"}}}]}"""

@Suppress("ktlint:standard:max-line-length")
const val validFHIRRecord2 =
    """{"resourceType":"Bundle","id":"1667861767830636000.7db38d22-b713-49fc-abfa-2edba9c09876","meta":{"lastUpdated":"2022-11-07T22:56:07.832+00:00"},"identifier":{"value":"1234d1d1-95fe-462c-8ac6-46728dbau8cd"},"type":"message","timestamp":"2021-08-03T13:15:11.015+00:00","entry":[{"fullUrl":"Observation/d683b42a-bf50-45e8-9fce-6c0531994f09","resource":{"resourceType":"Observation","id":"d683b42a-bf50-45e8-9fce-6c0531994f09","status":"final","code":{"coding":[{"system":"http://loinc.org","code":"41458-1"}],"text":"SARS "},"subject":{"reference":"Patient/9473889b-b2b9-45ac-a8d8-191f27132912"},"performer":[{"reference":"Organization/1a0139b9-fc23-450b-9b6c-cd081e5cea9d"}],"valueCodeableConcept":{"coding":[{"system":"http://snomed.info/sct","code":"260373001","display":"Detected"}]},"interpretation":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0078","code":"A","display":"Abnormal"}]}],"method":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/testkit-name-id","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/equipment-uid","valueCoding":{"code":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B_Becton, Dickinson and Company (BD)"}}],"coding":[{"display":"BD Veritor System for Rapid Detection of SARS-CoV-2 & Flu A+B*"}]},"specimen":{"reference":"Specimen/52a582e4-d389-42d0-b738-bee51cf5244d"},"device":{"reference":"Device/78dc4d98-2958-43a3-a445-76ceef8c0698"}}}]}"""

const val invalidEmptyFHIRRecord = "{}"
const val invalidMalformedFHIRRecord = """{"resourceType":"Bund}"""

@Suppress("ktlint:standard:max-line-length")
const val cleanHL7Record =
    """MSH|^~\&|CDC PRIME - Atlanta, Georgia (Dekalb)^2.16.840.1.114222.4.1.237821^ISO|Avante at Ormond Beach^10D0876999^CLIA|PRIME_DOH|Prime ReportStream|20210210170737||ORU^R01^ORU_R01|371784|P|2.5.1|||NE|NE|USA||||PHLabReportNoAck^ELR_Receiver^2.16.840.1.113883.9.99^ISO
SFT|Centers for Disease Control and Prevention|0.1-SNAPSHOT|PRIME ReportStream|0.1-SNAPSHOT||20210210
PID|1||2a14112c-ece1-4f82-915c-7b3a8d152eda^^^Avante at Ormond Beach^PI||Buckridge^Kareem^Millie^^^^L||19580810|F||2106-3^White^HL70005^^^^2.5.1|688 Leighann Inlet^^South Rodneychester^TX^67071^^^^48077||7275555555:1:^PRN^^roscoe.wilkinson@email.com^1^211^2240784|||||||||U^Unknown^HL70189||||||||N
ORC|RE|73a6e9bd-aaec-418e-813a-0ad33366ca85|73a6e9bd-aaec-418e-813a-0ad33366ca85|||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI||^WPN^^^1^386^6825220|20210209||||||Avante at Ormond Beach|170 North King Road^^Ormond Beach^FL^32174^^^^12127|^WPN^^jbrush@avantecenters.com^1^407^7397506|^^^^32174
OBR|1|73a6e9bd-aaec-418e-813a-0ad33366ca85|0cba76f5-35e0-4a28-803a-2f31308aae9b|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN|||202102090000-0600|202102090000-0600||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI|^WPN^^^1^386^6825220|||||202102090000-0600|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN||260415000^Not detected^SCT|||N^Normal (applies to non-numeric results)^HL70078|||F|||202102090000-0600|||CareStart COVID-19 Antigen test_Access Bio, Inc._EUA^^99ELR||202102090000-0600||||Avante at Ormond Beach^^^^^CLIA&2.16.840.1.113883.4.7&ISO^^^^10D0876999^CLIA|170 North King Road^^Ormond Beach^FL^32174^^^^12127
OBX|2|CWE|95418-0^Whether patient is employed in a healthcare setting^LN||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|3|CWE|95417-2^First test for condition of interest^LN||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|4|CWE|95421-4^Resides in a congregate care setting^LN||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|5|CWE|95419-8^Has symptoms related to condition of interest^LN||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
SPM|1|0cba76f5-35e0-4a28-803a-2f31308aae9b||258500001^Nasopharyngeal swab^SCT||||71836000^Nasopharyngeal structure (body structure)^SCT^^^^2020-09-01|||||||||202102090000-0600|202102090000-0600"""

@Suppress("ktlint:standard:max-line-length")
const val cleanHL7RecordConverted =
    """{"resourceType" : "Bundle","id" : "1713996284691766000.58f5fdfe-268f-4841-83f0-c35f0dc9f661","meta" : {"lastUpdated" : "2024-04-24T18:04:44.698-04:00"},"identifier" : {"system" : "https://reportstream.cdc.gov/prime-router","value" : "371784"},"type" : "message","timestamp" : "2021-02-10T17:07:37.000-05:00","entry" : [ {"fullUrl" : "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e","resource" : {"resourceType" : "MessageHeader","id" : "4aeed951-99a9-3152-8885-6b0acc6dd35e","meta" : {"tag" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0103","code" : "P"} ]},"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/msh-message-header","extension" : [ {"url" : "MSH.7","valueString" : "20210210170737"}, {"url" : "MSH.15","valueString" : "NE"}, {"url" : "MSH.16","valueString" : "NE"}, {"url" : "MSH.21","valueIdentifier" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "ELR_Receiver"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.9.99"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]} ],"value" : "PHLabReportNoAck"}} ]} ],"eventCoding" : {"system" : "http://terminology.hl7.org/CodeSystem/v2-0003","code" : "R01","display" : "ORU^R01^ORU_R01"},"destination" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.5"} ],"name" : "PRIME_DOH","_endpoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"receiver" : {"reference" : "Organization/1713996284765501000.0a335f22-9b51-48b0-aa98-60c301d5f44d"}} ],"sender" : {"reference" : "Organization/1713996284740932000.78170000-ec23-4029-aa10-76f01e1370fd"},"source" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CDC PRIME - Atlanta, Georgia (Dekalb)"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.114222.4.1.237821"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString" : "ISO"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.3"} ],"software" : "PRIME ReportStream","version" : "0.1-SNAPSHOT","endpoint" : "urn:oid:2.16.840.1.114222.4.1.237821"}}}, {"fullUrl" : "Organization/1713996284740932000.78170000-ec23-4029-aa10-76f01e1370fd","resource" : {"resourceType" : "Organization","id" : "1713996284740932000.78170000-ec23-4029-aa10-76f01e1370fd","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.2,HD.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301","code" : "CLIA"} ]},"value" : "10D0876999"} ],"address" : [ {"country" : "USA"} ]}}, {"fullUrl" : "Organization/1713996284765501000.0a335f22-9b51-48b0-aa98-60c301d5f44d","resource" : {"resourceType" : "Organization","id" : "1713996284765501000.0a335f22-9b51-48b0-aa98-60c301d5f44d","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.6"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Prime ReportStream"} ]}}, {"fullUrl" : "Provenance/1713996285077204000.c5e96872-c4d8-47d3-b153-30ae55b3c88d","resource" : {"resourceType" : "Provenance","id" : "1713996285077204000.c5e96872-c4d8-47d3-b153-30ae55b3c88d","target" : [ {"reference" : "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e"}, {"reference" : "DiagnosticReport/1713996285323354000.317916f0-a036-4292-90ba-de0ff9c770f6"} ],"recorded" : "2021-02-10T17:07:37Z","activity" : {"coding" : [ {"display" : "ORU^R01^ORU_R01"} ]},"agent" : [ {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/provenance-participant-type","code" : "author"} ]},"who" : {"reference" : "Organization/1713996285076406000.2eaba751-4c9d-40f4-aae1-08eca54bccaa"}} ],"entity" : [ {"role" : "source","what" : {"reference" : "Device/1713996285080554000.54472bf6-696f-42ba-8298-717d3d16c25f"}} ]}}, {"fullUrl" : "Organization/1713996285076406000.2eaba751-4c9d-40f4-aae1-08eca54bccaa","resource" : {"resourceType" : "Organization","id" : "1713996285076406000.2eaba751-4c9d-40f4-aae1-08eca54bccaa","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.2,HD.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301","code" : "CLIA"} ]},"value" : "10D0876999"} ]}}, {"fullUrl" : "Organization/1713996285080297000.595c44bc-0ca9-44ca-ae2e-3e0db26d4078","resource" : {"resourceType" : "Organization","id" : "1713996285080297000.595c44bc-0ca9-44ca-ae2e-3e0db26d4078","name" : "Centers for Disease Control and Prevention"}}, {"fullUrl" : "Device/1713996285080554000.54472bf6-696f-42ba-8298-717d3d16c25f","resource" : {"resourceType" : "Device","id" : "1713996285080554000.54472bf6-696f-42ba-8298-717d3d16c25f","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/software-vendor-org","valueReference" : {"reference" : "Organization/1713996285080297000.595c44bc-0ca9-44ca-ae2e-3e0db26d4078"}} ],"manufacturer" : "Centers for Disease Control and Prevention","deviceName" : [ {"name" : "PRIME ReportStream","type" : "manufacturer-name"} ],"modelNumber" : "0.1-SNAPSHOT","version" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/software-install-date","valueDateTime" : "2021-02-10","_valueDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "20210210"} ]}} ],"value" : "0.1-SNAPSHOT"} ]}}, {"fullUrl" : "Provenance/1713996285087205000.310d57f9-39f8-483c-b29b-468b0fdd665a","resource" : {"resourceType" : "Provenance","id" : "1713996285087205000.310d57f9-39f8-483c-b29b-468b0fdd665a","recorded" : "2024-04-24T18:04:45Z","policy" : [ "http://hl7.org/fhir/uv/v2mappings/message-oru-r01-to-bundle" ],"activity" : {"coding" : [ {"code" : "v2-FHIR transformation"} ]},"agent" : [ {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/provenance-participant-type","code" : "assembler"} ]},"who" : {"reference" : "Organization/1713996285086841000.87176205-5474-431b-b32d-6d6cee6778c7"}} ]}}, {"fullUrl" : "Organization/1713996285086841000.87176205-5474-431b-b32d-6d6cee6778c7","resource" : {"resourceType" : "Organization","id" : "1713996285086841000.87176205-5474-431b-b32d-6d6cee6778c7","identifier" : [ {"value" : "CDC PRIME - Atlanta"}, {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301"} ]},"system" : "urn:ietf:rfc:3986","value" : "2.16.840.1.114222.4.1.237821"} ]}}, {"fullUrl" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193","resource" : {"resourceType" : "Patient","id" : "1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/pid-patient","extension" : [ {"url" : "PID.8","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"} ],"code" : "F"} ]}}, {"url" : "PID.30","valueString" : "N"} ]}, {"url" : "http://ibm.com/fhir/cdm/StructureDefinition/local-race-cd","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70005"} ],"system" : "http://terminology.hl7.org/CodeSystem/v3-Race","version" : "2.5.1","code" : "2106-3","display" : "White"} ]}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/ethnic-group","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70189"} ],"system" : "http://terminology.hl7.org/CodeSystem/v2-0189","code" : "U","display" : "Unknown"} ]}} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cx-identifier","extension" : [ {"url" : "CX.5","valueString" : "PI"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "PID.3"} ],"type" : {"coding" : [ {"code" : "PI"} ]},"value" : "2a14112c-ece1-4f82-915c-7b3a8d152eda","assigner" : {"reference" : "Organization/1713996285093709000.e50f83ff-7e2b-41d7-87d3-ef2f6b34e98b"}} ],"name" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xpn-human-name","extension" : [ {"url" : "XPN.2","valueString" : "Kareem"}, {"url" : "XPN.3","valueString" : "Millie"}, {"url" : "XPN.7","valueString" : "L"} ]} ],"use" : "official","family" : "Buckridge","given" : [ "Kareem", "Millie" ]} ],"telecom" : [ {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "211"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "2240784"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.1","valueString" : "7275555555:1:"}, {"url" : "XTN.2","valueString" : "PRN"}, {"url" : "XTN.4","valueString" : "roscoe.wilkinson@email.com"}, {"url" : "XTN.7","valueString" : "2240784"} ]} ],"system" : "email","use" : "home"} ],"gender" : "female","birthDate" : "1958-08-10","_birthDate" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "19580810"} ]},"deceasedBoolean" : false,"address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "688 Leighann Inlet"} ]} ]} ],"line" : [ "688 Leighann Inlet" ],"city" : "South Rodneychester","district" : "48077","state" : "TX","postalCode" : "67071"} ]}}, {"fullUrl" : "Organization/1713996285093709000.e50f83ff-7e2b-41d7-87d3-ef2f6b34e98b","resource" : {"resourceType" : "Organization","id" : "1713996285093709000.e50f83ff-7e2b-41d7-87d3-ef2f6b34e98b","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"} ]}}, {"fullUrl" : "Provenance/1713996285113714000.2664c3d8-a07d-4c9f-b8b0-fe5c05d36ec9","resource" : {"resourceType" : "Provenance","id" : "1713996285113714000.2664c3d8-a07d-4c9f-b8b0-fe5c05d36ec9","target" : [ {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"} ],"recorded" : "2024-04-24T18:04:45Z","activity" : {"coding" : [ {"system" : "https://terminology.hl7.org/CodeSystem/v3-DataOperation","code" : "UPDATE"} ]}}}, {"fullUrl" : "Observation/1713996285117160000.36e10ec9-11e4-4acb-ab66-f3fc739faf89","resource" : {"resourceType" : "Observation","id" : "1713996285117160000.36e10ec9-11e4-4acb-ab66-f3fc739faf89","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/analysis-date-time","valueDateTime" : "2021-02-09T00:00:00-06:00","_valueDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"}, {"url" : "OBX.17","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "99ELR"} ],"code" : "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"} ]}} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"performer" : [ {"reference" : "Organization/1713996285118390000.c728eab6-bc50-41a7-a777-0ac1301310ab"} ],"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","code" : "260415000","display" : "Not detected"} ]},"interpretation" : [ {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70078"} ],"code" : "N","display" : "Normal (applies to non-numeric results)"} ]} ],"method" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "99ELR"} ],"code" : "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"} ]}}}, {"fullUrl" : "Organization/1713996285118390000.c728eab6-bc50-41a7-a777-0ac1301310ab","resource" : {"resourceType" : "Organization","id" : "1713996285118390000.c728eab6-bc50-41a7-a777-0ac1301310ab","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization","extension" : [ {"url" : "XON.10","valueString" : "10D0876999"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "OBX.25"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CLIA"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.4.7"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]} ],"value" : "10D0876999"} ],"name" : "Avante at Ormond Beach","address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"} ]}}, {"fullUrl" : "Observation/1713996285121730000.9adab1b8-4043-4bc9-9913-bd38c58158fa","resource" : {"resourceType" : "Observation","id" : "1713996285121730000.9adab1b8-4043-4bc9-9913-bd38c58158fa","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95418-0","display" : "Whether patient is employed in a healthcare setting"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "Y","display" : "Yes"} ]}}}, {"fullUrl" : "Observation/1713996285124027000.37e33966-b82d-4468-aaa2-1a105d1b63a4","resource" : {"resourceType" : "Observation","id" : "1713996285124027000.37e33966-b82d-4468-aaa2-1a105d1b63a4","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95417-2","display" : "First test for condition of interest"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "Y","display" : "Yes"} ]}}}, {"fullUrl" : "Observation/1713996285126492000.666b317b-8f51-4442-a440-d22331b667fb","resource" : {"resourceType" : "Observation","id" : "1713996285126492000.666b317b-8f51-4442-a440-d22331b667fb","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95421-4","display" : "Resides in a congregate care setting"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "N","display" : "No"} ]}}}, {"fullUrl" : "Observation/1713996285129541000.77a6af57-5f26-44a2-9266-b7d97561c7f6","resource" : {"resourceType" : "Observation","id" : "1713996285129541000.77a6af57-5f26-44a2-9266-b7d97561c7f6","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95419-8","display" : "Has symptoms related to condition of interest"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "N","display" : "No"} ]}}}, {"fullUrl" : "Specimen/1713996285303383000.8ae9e904-7261-40bb-a8cd-2e1dc2000e0e","resource" : {"resourceType" : "Specimen","id" : "1713996285303383000.8ae9e904-7261-40bb-a8cd-2e1dc2000e0e","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString" : "OBR"} ]}}, {"fullUrl" : "Specimen/1713996285305904000.ecf004fb-5aee-42d7-834a-e993fd0051ea","resource" : {"resourceType" : "Specimen","id" : "1713996285305904000.ecf004fb-5aee-42d7-834a-e993fd0051ea","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString" : "SPM"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Component","valueString" : "SPM.2.1"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PGN"} ]},"value" : "0cba76f5-35e0-4a28-803a-2f31308aae9b"} ],"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","code" : "258500001","display" : "Nasopharyngeal swab"} ]},"receivedTime" : "2021-02-09T00:00:00-06:00","_receivedTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"collection" : {"collectedDateTime" : "2021-02-09T00:00:00-06:00","_collectedDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"bodySite" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","version" : "2020-09-01","code" : "71836000","display" : "Nasopharyngeal structure (body structure)"} ]}}}}, {"fullUrl" : "ServiceRequest/1713996285318577000.a483c674-d00d-43ef-9657-aedd261e5ee8","resource" : {"resourceType" : "ServiceRequest","id" : "1713996285318577000.a483c674-d00d-43ef-9657-aedd261e5ee8","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/business-event","valueCode" : "RE"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/orc-common-order","extension" : [ {"url" : "orc-21-ordering-facility-name","valueReference" : {"reference" : "Organization/1713996285312090000.8de6ca50-1a82-4467-8656-4f95d3ee4d91"}}, {"url" : "orc-22-ordering-facility-address","valueAddress" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"}}, {"url" : "orc-24-ordering-provider-address","valueAddress" : {"postalCode" : "32174"}}, {"url" : "orc-12-ordering-provider","valueReference" : {"reference" : "Practitioner/1713996285314780000.b7d28361-61e1-4354-b6ea-f7e5c381f333"}}, {"url" : "ORC.15","valueString" : "20210209"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obr-observation-request","extension" : [ {"url" : "OBR.2","valueIdentifier" : {"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}}, {"url" : "OBR.3","valueIdentifier" : {"value" : "0cba76f5-35e0-4a28-803a-2f31308aae9b"}}, {"url" : "OBR.22","valueString" : "202102090000-0600"}, {"url" : "OBR.16","valueReference" : {"reference" : "Practitioner/1713996285317270000.d9aedb86-fc3a-4547-a7e6-5212e3f3ad9f"}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "386"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "6825220"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.7","valueString" : "6825220"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "OBR.17"} ],"_system" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"use" : "work"}} ]} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.2"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PLAC"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "FILL"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"} ],"status" : "unknown","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"requester" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "386"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "6825220"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.7","valueString" : "6825220"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.14"} ],"_system" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"use" : "work"}} ],"reference" : "PractitionerRole/1713996285307005000.ffde19f6-06fe-4546-8d34-14211f577f15"}}}, {"fullUrl" : "Practitioner/1713996285308542000.a8dea6bf-2535-4f9a-9f74-3595be33aaf3","resource" : {"resourceType" : "Practitioner","id" : "1713996285308542000.a8dea6bf-2535-4f9a-9f74-3595be33aaf3","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.12"} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ],"address" : [ {"postalCode" : "32174"} ]}}, {"fullUrl" : "Organization/1713996285310008000.6d55f17b-1635-40d0-85f1-932c458c647e","resource" : {"resourceType" : "Organization","id" : "1713996285310008000.6d55f17b-1635-40d0-85f1-932c458c647e","name" : "Avante at Ormond Beach","telecom" : [ {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "407"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "7397506"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.4","valueString" : "jbrush@avantecenters.com"}, {"url" : "XTN.7","valueString" : "7397506"} ]} ],"system" : "email","use" : "work"} ],"address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"} ]}}, {"fullUrl" : "PractitionerRole/1713996285307005000.ffde19f6-06fe-4546-8d34-14211f577f15","resource" : {"resourceType" : "PractitionerRole","id" : "1713996285307005000.ffde19f6-06fe-4546-8d34-14211f577f15","practitioner" : {"reference" : "Practitioner/1713996285308542000.a8dea6bf-2535-4f9a-9f74-3595be33aaf3"},"organization" : {"reference" : "Organization/1713996285310008000.6d55f17b-1635-40d0-85f1-932c458c647e"}}}, {"fullUrl" : "Organization/1713996285312090000.8de6ca50-1a82-4467-8656-4f95d3ee4d91","resource" : {"resourceType" : "Organization","id" : "1713996285312090000.8de6ca50-1a82-4467-8656-4f95d3ee4d91","name" : "Avante at Ormond Beach"}}, {"fullUrl" : "Practitioner/1713996285314780000.b7d28361-61e1-4354-b6ea-f7e5c381f333","resource" : {"resourceType" : "Practitioner","id" : "1713996285314780000.b7d28361-61e1-4354-b6ea-f7e5c381f333","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ]}}, {"fullUrl" : "Practitioner/1713996285317270000.d9aedb86-fc3a-4547-a7e6-5212e3f3ad9f","resource" : {"resourceType" : "Practitioner","id" : "1713996285317270000.d9aedb86-fc3a-4547-a7e6-5212e3f3ad9f","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ]}}, {"fullUrl" : "DiagnosticReport/1713996285323354000.317916f0-a036-4292-90ba-de0ff9c770f6","resource" : {"resourceType" : "DiagnosticReport","id" : "1713996285323354000.317916f0-a036-4292-90ba-de0ff9c770f6","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.2"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PLAC"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "FILL"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"} ],"basedOn" : [ {"reference" : "ServiceRequest/1713996285318577000.a483c674-d00d-43ef-9657-aedd261e5ee8"} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996285110828000.b280bdbd-3c11-4c6e-8949-491e0d7bc193"},"effectivePeriod" : {"start" : "2021-02-09T00:00:00-06:00","_start" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"end" : "2021-02-09T00:00:00-06:00","_end" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]}},"issued" : "2021-02-09T00:00:00-06:00","_issued" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"specimen" : [ {"reference" : "Specimen/1713996285305904000.ecf004fb-5aee-42d7-834a-e993fd0051ea"}, {"reference" : "Specimen/1713996285303383000.8ae9e904-7261-40bb-a8cd-2e1dc2000e0e"} ],"result" : [ {"reference" : "Observation/1713996285117160000.36e10ec9-11e4-4acb-ab66-f3fc739faf89"}, {"reference" : "Observation/1713996285121730000.9adab1b8-4043-4bc9-9913-bd38c58158fa"}, {"reference" : "Observation/1713996285124027000.37e33966-b82d-4468-aaa2-1a105d1b63a4"}, {"reference" : "Observation/1713996285126492000.666b317b-8f51-4442-a440-d22331b667fb"}, {"reference" : "Observation/1713996285129541000.77a6af57-5f26-44a2-9266-b7d97561c7f6"}]}}]}"""

@Suppress("ktlint:standard:max-line-length")
const val cleanHL7RecordConvertedAndTransformed =
    """{"resourceType": "Bundle", "id": "1714075986350543000.8e8b0e71-a366-41cc-acca-041376e7b05e", "meta": {"lastUpdated": "2024-04-25T16:13:06.357-04:00"}, "identifier": {"system": "https://reportstream.cdc.gov/prime-router", "value": "371784"}, "type": "message", "timestamp": "2021-02-10T17:07:37.000-05:00", "entry": [{"fullUrl": "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e", "resource": {"resourceType": "MessageHeader", "id": "4aeed951-99a9-3152-8885-6b0acc6dd35e", "meta": {"tag": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0103", "code": "P"}]}, "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/msh-message-header", "extension": [{"url": "MSH.7", "valueString": "20210210170737"}, {"url": "MSH.15", "valueString": "NE"}, {"url": "MSH.16", "valueString": "NE"}, {"url": "MSH.21", "valueIdentifier": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "ELR_Receiver"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.9.99"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}], "value": "PHLabReportNoAck"}}, {"url": "MSH.19", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "ISO"}], "code": "ENG", "display": "English"}]}}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/character-set", "valueString": "UNICODE UTF-8"}], "eventCoding": {"system": "http://terminology.hl7.org/CodeSystem/v2-0003", "code": "R01", "display": "ORU^R01^ORU_R01"}, "destination": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.5"}], "name": "PRIME_DOH", "_endpoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "receiver": {"reference": "Organization/1714075986425376000.cb936de7-9452-42d7-86c3-f57fd8ddfbe3"}}], "sender": {"reference": "Organization/1714075986401657000.30e02219-032e-47ce-894b-4fa29e81f6bd"}, "source": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CDC PRIME - Atlanta, Georgia (Dekalb)"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.114222.4.1.237821"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueString": "ISO"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.3"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-binary-id", "valueString": "0.2-SNAPSHOT"}], "name": "CDC PRIME - Atlanta: 2.16.840.1.114222.4.1.237821", "software": "PRIME ReportStream", "version": "0.2-SNAPSHOT", "endpoint": "urn:oid:2.16.840.1.114222.4.1.237821"}}}, {"fullUrl": "Organization/1714075986401657000.30e02219-032e-47ce-894b-4fa29e81f6bd", "resource": {"resourceType": "Organization", "id": "1714075986401657000.30e02219-032e-47ce-894b-4fa29e81f6bd", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.2,HD.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301", "code": "CLIA"}]}, "value": "10D0876999"}], "address": [{"country": "USA"}]}}, {"fullUrl": "Organization/1714075986425376000.cb936de7-9452-42d7-86c3-f57fd8ddfbe3", "resource": {"resourceType": "Organization", "id": "1714075986425376000.cb936de7-9452-42d7-86c3-f57fd8ddfbe3", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.6"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Prime ReportStream"}]}}, {"fullUrl": "Provenance/1714075986727087000.4e6970c6-01b3-4612-b376-35483edc9bbd", "resource": {"resourceType": "Provenance", "id": "1714075986727087000.4e6970c6-01b3-4612-b376-35483edc9bbd", "target": [{"reference": "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e"}, {"reference": "DiagnosticReport/1714075986955034000.cc978b59-ca68-4ffd-acba-9572836be3a7"}], "recorded": "2021-02-10T17:07:37Z", "activity": {"coding": [{"display": "ORU^R01^ORU_R01"}]}, "agent": [{"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/provenance-participant-type", "code": "author"}]}, "who": {"reference": "Organization/1714075986726387000.702ee15b-9579-4fc5-90ba-61687ccae7a2"}}], "entity": [{"role": "source", "what": {"reference": "Device/1714075986730018000.6da6ceec-1bc0-4a02-9337-6d2004f489dc"}}]}}, {"fullUrl": "Organization/1714075986726387000.702ee15b-9579-4fc5-90ba-61687ccae7a2", "resource": {"resourceType": "Organization", "id": "1714075986726387000.702ee15b-9579-4fc5-90ba-61687ccae7a2", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.2,HD.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301", "code": "CLIA"}]}, "value": "10D0876999"}]}}, {"fullUrl": "Organization/1714075986729787000.6c913b49-e6ed-42ac-9394-0179bf943dac", "resource": {"resourceType": "Organization", "id": "1714075986729787000.6c913b49-e6ed-42ac-9394-0179bf943dac", "name": "Centers for Disease Control and Prevention"}}, {"fullUrl": "Device/1714075986730018000.6da6ceec-1bc0-4a02-9337-6d2004f489dc", "resource": {"resourceType": "Device", "id": "1714075986730018000.6da6ceec-1bc0-4a02-9337-6d2004f489dc", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-vendor-org", "valueReference": {"reference": "Organization/1714075986729787000.6c913b49-e6ed-42ac-9394-0179bf943dac"}}], "manufacturer": "Centers for Disease Control and Prevention", "deviceName": [{"name": "PRIME ReportStream", "type": "manufacturer-name"}], "modelNumber": "0.1-SNAPSHOT", "version": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-install-date", "valueDateTime": "2021-02-10", "_valueDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "20210210"}]}}], "value": "0.1-SNAPSHOT"}]}}, {"fullUrl": "Provenance/1714075986736704000.6f33e8d5-9a09-420a-a62a-ea54cf980008", "resource": {"resourceType": "Provenance", "id": "1714075986736704000.6f33e8d5-9a09-420a-a62a-ea54cf980008", "recorded": "2024-04-25T16:13:06Z", "policy": ["http://hl7.org/fhir/uv/v2mappings/message-oru-r01-to-bundle"], "activity": {"coding": [{"code": "v2-FHIR transformation"}]}, "agent": [{"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/provenance-participant-type", "code": "assembler"}]}, "who": {"reference": "Organization/1714075986736409000.4cda0569-e1f1-491e-b91c-f547183ee8b6"}}]}}, {"fullUrl": "Organization/1714075986736409000.4cda0569-e1f1-491e-b91c-f547183ee8b6", "resource": {"resourceType": "Organization", "id": "1714075986736409000.4cda0569-e1f1-491e-b91c-f547183ee8b6", "identifier": [{"value": "CDC PRIME - Atlanta"}, {"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301"}]}, "system": "urn:ietf:rfc:3986", "value": "2.16.840.1.114222.4.1.237821"}]}}, {"fullUrl": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205", "resource": {"resourceType": "Patient", "id": "1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/pid-patient", "extension": [{"url": "PID.8", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}], "code": "F"}]}}, {"url": "PID.30", "valueString": "N"}]}, {"url": "http://ibm.com/fhir/cdm/StructureDefinition/local-race-cd", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70005"}], "system": "http://terminology.hl7.org/CodeSystem/v3-Race", "version": "2.5.1", "code": "2106-3", "display": "White"}]}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/ethnic-group", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70189"}], "system": "http://terminology.hl7.org/CodeSystem/v2-0189", "code": "U", "display": "Unknown"}]}}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cx-identifier", "extension": [{"url": "CX.5", "valueString": "PI"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "PID.3"}], "type": {"coding": [{"code": "PI"}]}, "value": "2a14112c-ece1-4f82-915c-7b3a8d152eda", "assigner": {"reference": "Organization/1714075986743741000.61cd6b50-d1db-4f02-8ce3-d004958259f6"}}], "name": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xpn-human-name", "extension": [{"url": "XPN.2", "valueString": "Kareem"}, {"url": "XPN.3", "valueString": "Millie"}, {"url": "XPN.7", "valueString": "L"}]}], "use": "official", "family": "Buckridge", "given": ["Kareem", "Millie"]}], "telecom": [{"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "211"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "2240784"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.1", "valueString": "7275555555:1:"}, {"url": "XTN.2", "valueString": "PRN"}, {"url": "XTN.4", "valueString": "roscoe.wilkinson@email.com"}, {"url": "XTN.7", "valueString": "2240784"}]}], "system": "email", "use": "home"}], "gender": "female", "birthDate": "1958-08-10", "_birthDate": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "19580810"}]}, "deceasedBoolean": false, "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "688 Leighann Inlet"}]}]}], "line": ["688 Leighann Inlet"], "city": "South Rodneychester", "district": "48077", "state": "TX", "postalCode": "67071"}]}}, {"fullUrl": "Organization/1714075986743741000.61cd6b50-d1db-4f02-8ce3-d004958259f6", "resource": {"resourceType": "Organization", "id": "1714075986743741000.61cd6b50-d1db-4f02-8ce3-d004958259f6", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}]}}, {"fullUrl": "Provenance/1714075986762376000.e7a4e0a5-097f-42c0-ad1f-79d538074ac4", "resource": {"resourceType": "Provenance", "id": "1714075986762376000.e7a4e0a5-097f-42c0-ad1f-79d538074ac4", "target": [{"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}], "recorded": "2024-04-25T16:13:06Z", "activity": {"coding": [{"system": "https://terminology.hl7.org/CodeSystem/v3-DataOperation", "code": "UPDATE"}]}}}, {"fullUrl": "Observation/1714075986765741000.f425e3cf-0ddf-4af5-8b16-df83e7a62f81", "resource": {"resourceType": "Observation", "id": "1714075986765741000.f425e3cf-0ddf-4af5-8b16-df83e7a62f81", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/analysis-date-time", "valueDateTime": "2021-02-09T00:00:00-06:00", "_valueDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}, {"url": "OBX.17", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "99ELR"}], "code": "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"}]}}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "performer": [{"reference": "Organization/1714075986766962000.8235bb6e-92a0-4a54-ae1c-3db19770d69b"}], "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "code": "260415000", "display": "Not detected"}]}, "interpretation": [{"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70078"}], "code": "N", "display": "Normal (applies to non-numeric results)"}]}], "method": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "99ELR"}], "code": "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"}]}}}, {"fullUrl": "Organization/1714075986766962000.8235bb6e-92a0-4a54-ae1c-3db19770d69b", "resource": {"resourceType": "Organization", "id": "1714075986766962000.8235bb6e-92a0-4a54-ae1c-3db19770d69b", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization", "extension": [{"url": "XON.10", "valueString": "10D0876999"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "OBX.25"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CLIA"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.4.7"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}], "value": "10D0876999"}], "name": "Avante at Ormond Beach", "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}]}}, {"fullUrl": "Observation/1714075986770033000.37d8a1d9-ae7d-46fd-803f-d78e6aa6c1d9", "resource": {"resourceType": "Observation", "id": "1714075986770033000.37d8a1d9-ae7d-46fd-803f-d78e6aa6c1d9", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95418-0", "display": "Whether patient is employed in a healthcare setting"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "Y", "display": "Yes"}]}}}, {"fullUrl": "Observation/1714075986772515000.a4be52f4-ae35-4a3d-b175-c3ab08914b01", "resource": {"resourceType": "Observation", "id": "1714075986772515000.a4be52f4-ae35-4a3d-b175-c3ab08914b01", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95417-2", "display": "First test for condition of interest"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "Y", "display": "Yes"}]}}}, {"fullUrl": "Observation/1714075986774643000.9484ea7b-9305-4c74-9935-34b3c8d5f789", "resource": {"resourceType": "Observation", "id": "1714075986774643000.9484ea7b-9305-4c74-9935-34b3c8d5f789", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95421-4", "display": "Resides in a congregate care setting"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "N", "display": "No"}]}}}, {"fullUrl": "Observation/1714075986776639000.f1662223-7730-4a3e-91a3-955f0f06064d", "resource": {"resourceType": "Observation", "id": "1714075986776639000.f1662223-7730-4a3e-91a3-955f0f06064d", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95419-8", "display": "Has symptoms related to condition of interest"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "N", "display": "No"}]}}}, {"fullUrl": "Specimen/1714075986937410000.9df806cb-634d-4184-bc40-0ec32517f9ed", "resource": {"resourceType": "Specimen", "id": "1714075986937410000.9df806cb-634d-4184-bc40-0ec32517f9ed", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment", "valueString": "OBR"}]}}, {"fullUrl": "Specimen/1714075986939510000.57ef79ed-b452-4e86-a649-4c210e024d4b", "resource": {"resourceType": "Specimen", "id": "1714075986939510000.57ef79ed-b452-4e86-a649-4c210e024d4b", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment", "valueString": "SPM"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Component", "valueString": "SPM.2.1"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PGN"}]}, "value": "0cba76f5-35e0-4a28-803a-2f31308aae9b"}], "type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "code": "258500001", "display": "Nasopharyngeal swab"}]}, "receivedTime": "2021-02-09T00:00:00-06:00", "_receivedTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "collection": {"collectedDateTime": "2021-02-09T00:00:00-06:00", "_collectedDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "bodySite": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "version": "2020-09-01", "code": "71836000", "display": "Nasopharyngeal structure (body structure)"}]}}}}, {"fullUrl": "ServiceRequest/1714075986950489000.bef2097d-0fae-4fac-a174-f808320d4b83", "resource": {"resourceType": "ServiceRequest", "id": "1714075986950489000.bef2097d-0fae-4fac-a174-f808320d4b83", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/business-event", "valueCode": "RE"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/orc-common-order", "extension": [{"url": "orc-21-ordering-facility-name", "valueReference": {"reference": "Organization/1714075986945628000.5d9da1e6-8ef5-48d7-a5b8-8d9801d0b16e"}}, {"url": "orc-22-ordering-facility-address", "valueAddress": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}}, {"url": "orc-24-ordering-provider-address", "valueAddress": {"postalCode": "32174"}}, {"url": "orc-12-ordering-provider", "valueReference": {"reference": "Practitioner/1714075986946939000.8f0eaca3-2bc6-441f-849c-5a3c570c2ab8"}}, {"url": "ORC.15", "valueString": "20210209"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obr-observation-request", "extension": [{"url": "OBR.2", "valueIdentifier": {"value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}}, {"url": "OBR.3", "valueIdentifier": {"value": "0cba76f5-35e0-4a28-803a-2f31308aae9b"}}, {"url": "OBR.22", "valueString": "202102090000-0600"}, {"url": "OBR.16", "valueReference": {"reference": "Practitioner/1714075986949131000.664c9746-73e3-4367-9e19-3de556bd607d"}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number", "valueContactPoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "386"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "6825220"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.7", "valueString": "6825220"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "OBR.17"}], "_system": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "use": "work"}}]}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.2"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PLAC"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "FILL"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}], "status": "unknown", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "requester": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number", "valueContactPoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "386"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "6825220"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.7", "valueString": "6825220"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.14"}], "_system": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "use": "work"}}], "reference": "PractitionerRole/1714075986940575000.7585ac63-66b1-4aac-b4c8-bb001c5b6a08"}}}, {"fullUrl": "Practitioner/1714075986941882000.671361fe-8f80-4c43-9211-f9f9257fc9f7", "resource": {"resourceType": "Practitioner", "id": "1714075986941882000.671361fe-8f80-4c43-9211-f9f9257fc9f7", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.12"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "NPI"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "urn:oid:2.16.840.1.113883.4.6"}], "type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}], "address": [{"postalCode": "32174"}]}}, {"fullUrl": "Organization/1714075986942881000.080d0179-0c67-41cf-bff0-f2628dfbd21f", "resource": {"resourceType": "Organization", "id": "1714075986942881000.080d0179-0c67-41cf-bff0-f2628dfbd21f", "name": "Avante at Ormond Beach", "telecom": [{"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "407"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "7397506"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.4", "valueString": "jbrush@avantecenters.com"}, {"url": "XTN.7", "valueString": "7397506"}]}], "system": "email", "use": "work"}], "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}]}}, {"fullUrl": "PractitionerRole/1714075986940575000.7585ac63-66b1-4aac-b4c8-bb001c5b6a08", "resource": {"resourceType": "PractitionerRole", "id": "1714075986940575000.7585ac63-66b1-4aac-b4c8-bb001c5b6a08", "practitioner": {"reference": "Practitioner/1714075986941882000.671361fe-8f80-4c43-9211-f9f9257fc9f7"}, "organization": {"reference": "Organization/1714075986942881000.080d0179-0c67-41cf-bff0-f2628dfbd21f"}}}, {"fullUrl": "Organization/1714075986945628000.5d9da1e6-8ef5-48d7-a5b8-8d9801d0b16e", "resource": {"resourceType": "Organization", "id": "1714075986945628000.5d9da1e6-8ef5-48d7-a5b8-8d9801d0b16e", "name": "Avante at Ormond Beach"}}, {"fullUrl": "Practitioner/1714075986946939000.8f0eaca3-2bc6-441f-849c-5a3c570c2ab8", "resource": {"resourceType": "Practitioner", "id": "1714075986946939000.8f0eaca3-2bc6-441f-849c-5a3c570c2ab8", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}], "identifier": [{"type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}]}}, {"fullUrl": "Practitioner/1714075986949131000.664c9746-73e3-4367-9e19-3de556bd607d", "resource": {"resourceType": "Practitioner", "id": "1714075986949131000.664c9746-73e3-4367-9e19-3de556bd607d", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}], "identifier": [{"type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}]}}, {"fullUrl": "DiagnosticReport/1714075986955034000.cc978b59-ca68-4ffd-acba-9572836be3a7", "resource": {"resourceType": "DiagnosticReport", "id": "1714075986955034000.cc978b59-ca68-4ffd-acba-9572836be3a7", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.2"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PLAC"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "FILL"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}], "basedOn": [{"reference": "ServiceRequest/1714075986950489000.bef2097d-0fae-4fac-a174-f808320d4b83"}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714075986759616000.78cfdc07-349a-479b-a099-dc1bc510f205"}, "effectivePeriod": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valuePeriod": {"start": "2021-02-09T00:00:00-06:00", "_start": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "end": "2021-02-09T00:00:00-06:00", "_end": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}}], "start": "2021-02-09T00:00:00-06:00", "_start": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "end": "2021-02-09T00:00:00-06:00", "_end": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}, "issued": "2021-02-09T00:00:00-06:00", "_issued": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "specimen": [{"reference": "Specimen/1714075986939510000.57ef79ed-b452-4e86-a649-4c210e024d4b"}, {"reference": "Specimen/1714075986937410000.9df806cb-634d-4184-bc40-0ec32517f9ed"}], "result": [{"reference": "Observation/1714075986765741000.f425e3cf-0ddf-4af5-8b16-df83e7a62f81"}, {"reference": "Observation/1714075986770033000.37d8a1d9-ae7d-46fd-803f-d78e6aa6c1d9"}, {"reference": "Observation/1714075986772515000.a4be52f4-ae35-4a3d-b175-c3ab08914b01"}, {"reference": "Observation/1714075986774643000.9484ea7b-9305-4c74-9935-34b3c8d5f789"}, {"reference": "Observation/1714075986776639000.f1662223-7730-4a3e-91a3-955f0f06064d"}]}}]}"""

// This message will be parsed and successfully passed through the convert step
// despite having a nonexistent NNN segement and an SFT.2 that is not an ST
@Suppress("ktlint:standard:max-line-length")
const val invalidHL7Record =
    """MSH|^~\&|CDC PRIME - Atlanta, Georgia (Dekalb)^2.16.840.1.114222.4.1.237821^ISO|Avante at Ormond Beach^10D0876999^CLIA|PRIME_DOH|Prime ReportStream|20210210170737||ORU^R01^ORU_R01|371784|P|2.5.1|||NE|NE|USA||||PHLabReportNoAck^ELR_Receiver^2.16.840.1.113883.9.99^ISO
SFT|Centers for Disease Control and Prevention|0.1-SNAPSHOT^4^NH|PRIME ReportStream|0.1-SNAPSHOT||20210210
PID|1||2a14112c-ece1-4f82-915c-7b3a8d152eda^^^Avante at Ormond Beach^PI||Buckridge^Kareem^Millie^^^^L||19580810|F||2106-3^White^HL70005^^^^2.5.1|688 Leighann Inlet^^South Rodneychester^TX^67071^^^^48077||7275555555:1:^PRN^^roscoe.wilkinson@email.com^1^211^2240784|||||||||U^Unknown^HL70189||||||||N
ORC|RE|73a6e9bd-aaec-418e-813a-0ad33366ca85|73a6e9bd-aaec-418e-813a-0ad33366ca85|||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI||^WPN^^^1^386^6825220|20210209||||||Avante at Ormond Beach|170 North King Road^^Ormond Beach^FL^32174^^^^12127|^WPN^^jbrush@avantecenters.com^1^407^7397506|^^^^32174
OBR|1|73a6e9bd-aaec-418e-813a-0ad33366ca85|0cba76f5-35e0-4a28-803a-2f31308aae9b|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN|||202102090000-0600|202102090000-0600||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI|^WPN^^^1^386^6825220|||||202102090000-0600|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN||260415000^Not detected^SCT|||N^Normal (applies to non-numeric results)^HL70078|||F|||202102090000-0600|||CareStart COVID-19 Antigen test_Access Bio, Inc._EUA^^99ELR||202102090000-0600||||Avante at Ormond Beach^^^^^CLIA&2.16.840.1.113883.4.7&ISO^^^^10D0876999^CLIA|170 North King Road^^Ormond Beach^FL^32174^^^^12127
OBX|2|CWE|95418-0^Whether patient is employed in a healthcare setting^LN||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|3|CWE|95417-2^First test for condition of interest^LN||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|4|CWE|95421-4^Resides in a congregate care setting^LN||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
NNN|5|CWE|95419-8^Has symptoms related to condition of interest^LN||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
SPM|1|0cba76f5-35e0-4a28-803a-2f31308aae9b||258500001^Nasopharyngeal swab^SCT||||71836000^Nasopharyngeal structure (body structure)^SCT^^^^2020-09-01|||||||||202102090000-0600|202102090000-0600"""

@Suppress("ktlint:standard:max-line-length")
const val invalidHL7RecordConverted =
    """{"resourceType" : "Bundle","id" : "1713996344232402000.e6f0a740-e4b3-42c3-9ad1-245825f43a63","meta" : {"lastUpdated" : "2024-04-24T18:05:44.239-04:00"},"identifier" : {"system" : "https://reportstream.cdc.gov/prime-router","value" : "371784"},"type" : "message","timestamp" : "2021-02-10T17:07:37.000-05:00","entry" : [ {"fullUrl" : "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e","resource" : {"resourceType" : "MessageHeader","id" : "4aeed951-99a9-3152-8885-6b0acc6dd35e","meta" : {"tag" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0103","code" : "P"} ]},"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/msh-message-header","extension" : [ {"url" : "MSH.7","valueString" : "20210210170737"}, {"url" : "MSH.15","valueString" : "NE"}, {"url" : "MSH.16","valueString" : "NE"}, {"url" : "MSH.21","valueIdentifier" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "ELR_Receiver"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.9.99"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]} ],"value" : "PHLabReportNoAck"}} ]} ],"eventCoding" : {"system" : "http://terminology.hl7.org/CodeSystem/v2-0003","code" : "R01","display" : "ORU^R01^ORU_R01"},"destination" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.5"} ],"name" : "PRIME_DOH","_endpoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"receiver" : {"reference" : "Organization/1713996344323366000.80a08aea-6a14-4701-bf38-6a1fcd75f23f"}} ],"sender" : {"reference" : "Organization/1713996344294320000.ba1a4a79-18ee-4301-bf35-be8b97e05211"},"source" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CDC PRIME - Atlanta, Georgia (Dekalb)"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.114222.4.1.237821"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString" : "ISO"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.3"} ],"software" : "PRIME ReportStream","version" : "0.1-SNAPSHOT","endpoint" : "urn:oid:2.16.840.1.114222.4.1.237821"}}}, {"fullUrl" : "Organization/1713996344294320000.ba1a4a79-18ee-4301-bf35-be8b97e05211","resource" : {"resourceType" : "Organization","id" : "1713996344294320000.ba1a4a79-18ee-4301-bf35-be8b97e05211","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.2,HD.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301","code" : "CLIA"} ]},"value" : "10D0876999"} ],"address" : [ {"country" : "USA"} ]}}, {"fullUrl" : "Organization/1713996344323366000.80a08aea-6a14-4701-bf38-6a1fcd75f23f","resource" : {"resourceType" : "Organization","id" : "1713996344323366000.80a08aea-6a14-4701-bf38-6a1fcd75f23f","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "MSH.6"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Prime ReportStream"} ]}}, {"fullUrl" : "Provenance/1713996344645069000.c53f4af0-491c-4d29-9c1e-8ebfd08df2d2","resource" : {"resourceType" : "Provenance","id" : "1713996344645069000.c53f4af0-491c-4d29-9c1e-8ebfd08df2d2","target" : [ {"reference" : "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e"}, {"reference" : "DiagnosticReport/1713996345061146000.f4f88ded-2a17-4b63-a05b-ea775a67214b"} ],"recorded" : "2021-02-10T17:07:37Z","activity" : {"coding" : [ {"display" : "ORU^R01^ORU_R01"} ]},"agent" : [ {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/provenance-participant-type","code" : "author"} ]},"who" : {"reference" : "Organization/1713996344644134000.d41cdb08-5122-4665-9cac-2be3ec767f6b"}} ],"entity" : [ {"role" : "source","what" : {"reference" : "Device/1713996344648720000.9b2bcdf9-e082-4417-9e20-df8aca1e6368"}} ]}}, {"fullUrl" : "Organization/1713996344644134000.d41cdb08-5122-4665-9cac-2be3ec767f6b","resource" : {"resourceType" : "Organization","id" : "1713996344644134000.d41cdb08-5122-4665-9cac-2be3ec767f6b","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.2,HD.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301","code" : "CLIA"} ]},"value" : "10D0876999"} ]}}, {"fullUrl" : "Organization/1713996344648438000.b155490b-d3e7-4bfd-8133-48ddb3605d3f","resource" : {"resourceType" : "Organization","id" : "1713996344648438000.b155490b-d3e7-4bfd-8133-48ddb3605d3f","name" : "Centers for Disease Control and Prevention"}}, {"fullUrl" : "Device/1713996344648720000.9b2bcdf9-e082-4417-9e20-df8aca1e6368","resource" : {"resourceType" : "Device","id" : "1713996344648720000.9b2bcdf9-e082-4417-9e20-df8aca1e6368","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/software-vendor-org","valueReference" : {"reference" : "Organization/1713996344648438000.b155490b-d3e7-4bfd-8133-48ddb3605d3f"}} ],"manufacturer" : "Centers for Disease Control and Prevention","deviceName" : [ {"name" : "PRIME ReportStream","type" : "manufacturer-name"} ],"modelNumber" : "0.1-SNAPSHOT","version" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/software-install-date","valueDateTime" : "2021-02-10","_valueDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "20210210"} ]}} ],"value" : "0.1-SNAPSHOT"} ]}}, {"fullUrl" : "Provenance/1713996344655668000.6dfae4b0-1df3-4866-873e-a5a12355f7fc","resource" : {"resourceType" : "Provenance","id" : "1713996344655668000.6dfae4b0-1df3-4866-873e-a5a12355f7fc","recorded" : "2024-04-24T18:05:44Z","policy" : [ "http://hl7.org/fhir/uv/v2mappings/message-oru-r01-to-bundle" ],"activity" : {"coding" : [ {"code" : "v2-FHIR transformation"} ]},"agent" : [ {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/provenance-participant-type","code" : "assembler"} ]},"who" : {"reference" : "Organization/1713996344655154000.df23fcb5-0bb8-463e-b4aa-cb0f2acfab02"}} ]}}, {"fullUrl" : "Organization/1713996344655154000.df23fcb5-0bb8-463e-b4aa-cb0f2acfab02","resource" : {"resourceType" : "Organization","id" : "1713996344655154000.df23fcb5-0bb8-463e-b4aa-cb0f2acfab02","identifier" : [ {"value" : "CDC PRIME - Atlanta"}, {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0301"} ]},"system" : "urn:ietf:rfc:3986","value" : "2.16.840.1.114222.4.1.237821"} ]}}, {"fullUrl" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7","resource" : {"resourceType" : "Patient","id" : "1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/pid-patient","extension" : [ {"url" : "PID.8","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"} ],"code" : "F"} ]}}, {"url" : "PID.30","valueString" : "N"} ]}, {"url" : "http://ibm.com/fhir/cdm/StructureDefinition/local-race-cd","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70005"} ],"system" : "http://terminology.hl7.org/CodeSystem/v3-Race","version" : "2.5.1","code" : "2106-3","display" : "White"} ]}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/ethnic-group","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70189"} ],"system" : "http://terminology.hl7.org/CodeSystem/v2-0189","code" : "U","display" : "Unknown"} ]}} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cx-identifier","extension" : [ {"url" : "CX.5","valueString" : "PI"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "PID.3"} ],"type" : {"coding" : [ {"code" : "PI"} ]},"value" : "2a14112c-ece1-4f82-915c-7b3a8d152eda","assigner" : {"reference" : "Organization/1713996344663404000.94a1302d-ea79-4bc9-8383-35194fe9d019"}} ],"name" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xpn-human-name","extension" : [ {"url" : "XPN.2","valueString" : "Kareem"}, {"url" : "XPN.3","valueString" : "Millie"}, {"url" : "XPN.7","valueString" : "L"} ]} ],"use" : "official","family" : "Buckridge","given" : [ "Kareem", "Millie" ]} ],"telecom" : [ {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "211"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "2240784"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.1","valueString" : "7275555555:1:"}, {"url" : "XTN.2","valueString" : "PRN"}, {"url" : "XTN.4","valueString" : "roscoe.wilkinson@email.com"}, {"url" : "XTN.7","valueString" : "2240784"} ]} ],"system" : "email","use" : "home"} ],"gender" : "female","birthDate" : "1958-08-10","_birthDate" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "19580810"} ]},"deceasedBoolean" : false,"address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "688 Leighann Inlet"} ]} ]} ],"line" : [ "688 Leighann Inlet" ],"city" : "South Rodneychester","district" : "48077","state" : "TX","postalCode" : "67071"} ]}}, {"fullUrl" : "Organization/1713996344663404000.94a1302d-ea79-4bc9-8383-35194fe9d019","resource" : {"resourceType" : "Organization","id" : "1713996344663404000.94a1302d-ea79-4bc9-8383-35194fe9d019","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "HD.1"} ],"value" : "Avante at Ormond Beach"} ]}}, {"fullUrl" : "Provenance/1713996344685790000.6718424f-6fd0-4948-bafa-b31a5eed9989","resource" : {"resourceType" : "Provenance","id" : "1713996344685790000.6718424f-6fd0-4948-bafa-b31a5eed9989","target" : [ {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"} ],"recorded" : "2024-04-24T18:05:44Z","activity" : {"coding" : [ {"system" : "https://terminology.hl7.org/CodeSystem/v3-DataOperation","code" : "UPDATE"} ]}}}, {"fullUrl" : "Observation/1713996344689300000.640223d0-9423-4261-8a37-f5d856034a99","resource" : {"resourceType" : "Observation","id" : "1713996344689300000.640223d0-9423-4261-8a37-f5d856034a99","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/analysis-date-time","valueDateTime" : "2021-02-09T00:00:00-06:00","_valueDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"}, {"url" : "OBX.17","valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "99ELR"} ],"code" : "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"} ]}} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"performer" : [ {"reference" : "Organization/1713996344690666000.08422ec0-a3ce-4d91-87b4-67bb90832a8f"} ],"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","code" : "260415000","display" : "Not detected"} ]},"interpretation" : [ {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70078"} ],"code" : "N","display" : "Normal (applies to non-numeric results)"} ]} ],"method" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "99ELR"} ],"code" : "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"} ]}}}, {"fullUrl" : "Organization/1713996344690666000.08422ec0-a3ce-4d91-87b4-67bb90832a8f","resource" : {"resourceType" : "Organization","id" : "1713996344690666000.08422ec0-a3ce-4d91-87b4-67bb90832a8f","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization","extension" : [ {"url" : "XON.10","valueString" : "10D0876999"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "OBX.25"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CLIA"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.4.7"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]} ],"value" : "10D0876999"} ],"name" : "Avante at Ormond Beach","address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"} ]}}, {"fullUrl" : "Observation/1713996344694188000.9c5de748-d4cd-4714-9e8c-d124280ffaab","resource" : {"resourceType" : "Observation","id" : "1713996344694188000.9c5de748-d4cd-4714-9e8c-d124280ffaab","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95418-0","display" : "Whether patient is employed in a healthcare setting"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "Y","display" : "Yes"} ]}}}, {"fullUrl" : "Observation/1713996344697154000.92c561c5-18b1-4451-ba52-87022faba3a5","resource" : {"resourceType" : "Observation","id" : "1713996344697154000.92c561c5-18b1-4451-ba52-87022faba3a5","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95417-2","display" : "First test for condition of interest"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "Y","display" : "Yes"} ]}}}, {"fullUrl" : "Observation/1713996344699314000.4a443eca-9f7e-4201-af5d-7082badca0dc","resource" : {"resourceType" : "Observation","id" : "1713996344699314000.4a443eca-9f7e-4201-af5d-7082badca0dc","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension" : [ {"url" : "OBX.2","valueId" : "CWE"}, {"url" : "OBX.11","valueString" : "F"} ]} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "95421-4","display" : "Resides in a congregate care setting"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"effectiveDateTime" : "2021-02-09T00:00:00-06:00","_effectiveDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"valueCodeableConcept" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "HL70136"} ],"code" : "N","display" : "No"} ]}}}, {"fullUrl" : "Specimen/1713996345042384000.2e4b2726-a4a4-4ab5-8a57-fc5158d03391","resource" : {"resourceType" : "Specimen","id" : "1713996345042384000.2e4b2726-a4a4-4ab5-8a57-fc5158d03391","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString" : "OBR"} ]}}, {"fullUrl" : "Specimen/1713996345044785000.4c69b10e-3d62-4875-8474-b56ef8d4d6c3","resource" : {"resourceType" : "Specimen","id" : "1713996345044785000.4c69b10e-3d62-4875-8474-b56ef8d4d6c3","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString" : "SPM"} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Component","valueString" : "SPM.2.1"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PGN"} ]},"value" : "0cba76f5-35e0-4a28-803a-2f31308aae9b"} ],"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","code" : "258500001","display" : "Nasopharyngeal swab"} ]},"receivedTime" : "2021-02-09T00:00:00-06:00","_receivedTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"collection" : {"collectedDateTime" : "2021-02-09T00:00:00-06:00","_collectedDateTime" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"bodySite" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "SCT"} ],"system" : "http://snomed.info/sct","version" : "2020-09-01","code" : "71836000","display" : "Nasopharyngeal structure (body structure)"} ]}}}}, {"fullUrl" : "ServiceRequest/1713996345056024000.fde420dd-8a5e-44e7-b89f-aa4280fc1bba","resource" : {"resourceType" : "ServiceRequest","id" : "1713996345056024000.fde420dd-8a5e-44e7-b89f-aa4280fc1bba","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/business-event","valueCode" : "RE"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/orc-common-order","extension" : [ {"url" : "orc-21-ordering-facility-name","valueReference" : {"reference" : "Organization/1713996345051570000.de84af59-4434-42ef-980c-8ee784085803"}}, {"url" : "orc-22-ordering-facility-address","valueAddress" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"}}, {"url" : "orc-24-ordering-provider-address","valueAddress" : {"postalCode" : "32174"}}, {"url" : "orc-12-ordering-provider","valueReference" : {"reference" : "Practitioner/1713996345053171000.f11a1dde-c743-4dba-bf84-1a9405153712"}}, {"url" : "ORC.15","valueString" : "20210209"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/obr-observation-request","extension" : [ {"url" : "OBR.2","valueIdentifier" : {"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}}, {"url" : "OBR.3","valueIdentifier" : {"value" : "0cba76f5-35e0-4a28-803a-2f31308aae9b"}}, {"url" : "OBR.22","valueString" : "202102090000-0600"}, {"url" : "OBR.16","valueReference" : {"reference" : "Practitioner/1713996345054149000.75edadc5-8bae-41bf-af94-b11c40ea2c6e"}}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "386"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "6825220"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.7","valueString" : "6825220"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "OBR.17"} ],"_system" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"use" : "work"}} ]} ],"identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.2"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PLAC"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.3"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "FILL"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"} ],"status" : "unknown","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"requester" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "386"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "6825220"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.7","valueString" : "6825220"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.14"} ],"_system" : {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode" : "unknown"} ]},"use" : "work"}} ],"reference" : "PractitionerRole/1713996345046260000.979c13d9-b652-487b-bea9-10f76244213c"}}}, {"fullUrl" : "Practitioner/1713996345047406000.e53a3ebe-3cac-4b4d-84b0-e450dcf729e9","resource" : {"resourceType" : "Practitioner","id" : "1713996345047406000.e53a3ebe-3cac-4b4d-84b0-e450dcf729e9","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.12"} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ],"address" : [ {"postalCode" : "32174"} ]}}, {"fullUrl" : "Organization/1713996345048602000.f30179c4-820f-4219-ac1d-f6a26fd8f525","resource" : {"resourceType" : "Organization","id" : "1713996345048602000.f30179c4-820f-4219-ac1d-f6a26fd8f525","name" : "Avante at Ormond Beach","telecom" : [ {"extension" : [ {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-country","valueString" : "1"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString" : "407"}, {"url" : "http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString" : "7397506"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension" : [ {"url" : "XTN.2","valueString" : "WPN"}, {"url" : "XTN.4","valueString" : "jbrush@avantecenters.com"}, {"url" : "XTN.7","valueString" : "7397506"} ]} ],"system" : "email","use" : "work"} ],"address" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line","extension" : [ {"url" : "SAD.1","valueString" : "170 North King Road"} ]} ]} ],"line" : [ "170 North King Road" ],"city" : "Ormond Beach","district" : "12127","state" : "FL","postalCode" : "32174"} ]}}, {"fullUrl" : "PractitionerRole/1713996345046260000.979c13d9-b652-487b-bea9-10f76244213c","resource" : {"resourceType" : "PractitionerRole","id" : "1713996345046260000.979c13d9-b652-487b-bea9-10f76244213c","practitioner" : {"reference" : "Practitioner/1713996345047406000.e53a3ebe-3cac-4b4d-84b0-e450dcf729e9"},"organization" : {"reference" : "Organization/1713996345048602000.f30179c4-820f-4219-ac1d-f6a26fd8f525"}}}, {"fullUrl" : "Organization/1713996345051570000.de84af59-4434-42ef-980c-8ee784085803","resource" : {"resourceType" : "Organization","id" : "1713996345051570000.de84af59-4434-42ef-980c-8ee784085803","name" : "Avante at Ormond Beach"}}, {"fullUrl" : "Practitioner/1713996345053171000.f11a1dde-c743-4dba-bf84-1a9405153712","resource" : {"resourceType" : "Practitioner","id" : "1713996345053171000.f11a1dde-c743-4dba-bf84-1a9405153712","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ]}}, {"fullUrl" : "Practitioner/1713996345054149000.75edadc5-8bae-41bf-af94-b11c40ea2c6e","resource" : {"resourceType" : "Practitioner","id" : "1713996345054149000.75edadc5-8bae-41bf-af94-b11c40ea2c6e","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString" : "CMS"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString" : "2.16.840.1.113883.3.249"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode" : "ISO"} ]}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner","extension" : [ {"url" : "XCN.3","valueString" : "Husam"} ]} ],"identifier" : [ {"type" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id","valueBoolean" : true} ],"code" : "NPI"} ]},"system" : "CMS","value" : "1629082607"} ],"name" : [ {"family" : "Eddin","given" : [ "Husam" ]} ]}}, {"fullUrl" : "DiagnosticReport/1713996345061146000.f4f88ded-2a17-4b63-a05b-ea775a67214b","resource" : {"resourceType" : "DiagnosticReport","id" : "1713996345061146000.f4f88ded-2a17-4b63-a05b-ea775a67214b","identifier" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString" : "ORC.2"} ],"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "PLAC"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"type" : {"coding" : [ {"system" : "http://terminology.hl7.org/CodeSystem/v2-0203","code" : "FILL"} ]},"value" : "73a6e9bd-aaec-418e-813a-0ad33366ca85"} ],"basedOn" : [ {"reference" : "ServiceRequest/1713996345056024000.fde420dd-8a5e-44e7-b89f-aa4280fc1bba"} ],"status" : "final","code" : {"coding" : [ {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString" : "coding"}, {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString" : "LN"} ],"system" : "http://loinc.org","code" : "94558-4","display" : "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"} ]},"subject" : {"reference" : "Patient/1713996344682489000.2f1bd032-2044-4cd5-a406-046f010af8c7"},"effectivePeriod" : {"start" : "2021-02-09T00:00:00-06:00","_start" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"end" : "2021-02-09T00:00:00-06:00","_end" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]}},"issued" : "2021-02-09T00:00:00-06:00","_issued" : {"extension" : [ {"url" : "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString" : "202102090000-0600"} ]},"specimen" : [ {"reference" : "Specimen/1713996345044785000.4c69b10e-3d62-4875-8474-b56ef8d4d6c3"}, {"reference" : "Specimen/1713996345042384000.2e4b2726-a4a4-4ab5-8a57-fc5158d03391"} ],"result" : [ {"reference" : "Observation/1713996344689300000.640223d0-9423-4261-8a37-f5d856034a99"}, {"reference" : "Observation/1713996344694188000.9c5de748-d4cd-4714-9e8c-d124280ffaab"}, {"reference" : "Observation/1713996344697154000.92c561c5-18b1-4451-ba52-87022faba3a5"}, {"reference" : "Observation/1713996344699314000.4a443eca-9f7e-4201-af5d-7082badca0dc"}]}}]}"""

@Suppress("ktlint:standard:max-line-length")
const val invalidHL7RecordConvertedAndTransformed =
    """{"resourceType": "Bundle", "id": "1714076050088111000.a4c2ec65-b182-45da-9f14-80db72ebdd42", "meta": {"lastUpdated": "2024-04-25T16:14:10.094-04:00"}, "identifier": {"system": "https://reportstream.cdc.gov/prime-router", "value": "371784"}, "type": "message", "timestamp": "2021-02-10T17:07:37.000-05:00", "entry": [{"fullUrl": "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e", "resource": {"resourceType": "MessageHeader", "id": "4aeed951-99a9-3152-8885-6b0acc6dd35e", "meta": {"tag": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0103", "code": "P"}]}, "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/msh-message-header", "extension": [{"url": "MSH.7", "valueString": "20210210170737"}, {"url": "MSH.15", "valueString": "NE"}, {"url": "MSH.16", "valueString": "NE"}, {"url": "MSH.21", "valueIdentifier": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "ELR_Receiver"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.9.99"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}], "value": "PHLabReportNoAck"}}, {"url": "MSH.19", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "ISO"}], "code": "ENG", "display": "English"}]}}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/character-set", "valueString": "UNICODE UTF-8"}], "eventCoding": {"system": "http://terminology.hl7.org/CodeSystem/v2-0003", "code": "R01", "display": "ORU^R01^ORU_R01"}, "destination": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.5"}], "name": "PRIME_DOH", "_endpoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "receiver": {"reference": "Organization/1714076050159757000.4a754008-3c87-4a33-b464-b200e5209d58"}}], "sender": {"reference": "Organization/1714076050134101000.e2dfbcec-e00a-4145-9a1d-3f237f7d9c88"}, "source": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CDC PRIME - Atlanta, Georgia (Dekalb)"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.114222.4.1.237821"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueString": "ISO"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.3"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-binary-id", "valueString": "0.2-SNAPSHOT"}], "name": "CDC PRIME - Atlanta: 2.16.840.1.114222.4.1.237821", "software": "PRIME ReportStream", "version": "0.2-SNAPSHOT", "endpoint": "urn:oid:2.16.840.1.114222.4.1.237821"}}}, {"fullUrl": "Organization/1714076050134101000.e2dfbcec-e00a-4145-9a1d-3f237f7d9c88", "resource": {"resourceType": "Organization", "id": "1714076050134101000.e2dfbcec-e00a-4145-9a1d-3f237f7d9c88", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.2,HD.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301", "code": "CLIA"}]}, "value": "10D0876999"}], "address": [{"country": "USA"}]}}, {"fullUrl": "Organization/1714076050159757000.4a754008-3c87-4a33-b464-b200e5209d58", "resource": {"resourceType": "Organization", "id": "1714076050159757000.4a754008-3c87-4a33-b464-b200e5209d58", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "MSH.6"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Prime ReportStream"}]}}, {"fullUrl": "Provenance/1714076050445737000.c6aaf334-0a47-431f-9683-d684b448e75d", "resource": {"resourceType": "Provenance", "id": "1714076050445737000.c6aaf334-0a47-431f-9683-d684b448e75d", "target": [{"reference": "MessageHeader/4aeed951-99a9-3152-8885-6b0acc6dd35e"}, {"reference": "DiagnosticReport/1714076050653185000.919d3a83-8196-4559-9b09-82223811a264"}], "recorded": "2021-02-10T17:07:37Z", "activity": {"coding": [{"display": "ORU^R01^ORU_R01"}]}, "agent": [{"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/provenance-participant-type", "code": "author"}]}, "who": {"reference": "Organization/1714076050445166000.fe8affd3-6047-4d29-9946-48aa378eb7a8"}}], "entity": [{"role": "source", "what": {"reference": "Device/1714076050448504000.64bd61ad-a6ba-46ea-8c67-7925902c7ccb"}}]}}, {"fullUrl": "Organization/1714076050445166000.fe8affd3-6047-4d29-9946-48aa378eb7a8", "resource": {"resourceType": "Organization", "id": "1714076050445166000.fe8affd3-6047-4d29-9946-48aa378eb7a8", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.2,HD.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301", "code": "CLIA"}]}, "value": "10D0876999"}]}}, {"fullUrl": "Organization/1714076050448325000.62322707-039b-4e4d-b8bb-b98585947a1c", "resource": {"resourceType": "Organization", "id": "1714076050448325000.62322707-039b-4e4d-b8bb-b98585947a1c", "name": "Centers for Disease Control and Prevention"}}, {"fullUrl": "Device/1714076050448504000.64bd61ad-a6ba-46ea-8c67-7925902c7ccb", "resource": {"resourceType": "Device", "id": "1714076050448504000.64bd61ad-a6ba-46ea-8c67-7925902c7ccb", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-vendor-org", "valueReference": {"reference": "Organization/1714076050448325000.62322707-039b-4e4d-b8bb-b98585947a1c"}}], "manufacturer": "Centers for Disease Control and Prevention", "deviceName": [{"name": "PRIME ReportStream", "type": "manufacturer-name"}], "modelNumber": "0.1-SNAPSHOT", "version": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/software-install-date", "valueDateTime": "2021-02-10", "_valueDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "20210210"}]}}], "value": "0.1-SNAPSHOT"}]}}, {"fullUrl": "Provenance/1714076050454424000.121a6dc9-c486-4455-9720-3b3f1a3fe655", "resource": {"resourceType": "Provenance", "id": "1714076050454424000.121a6dc9-c486-4455-9720-3b3f1a3fe655", "recorded": "2024-04-25T16:14:10Z", "policy": ["http://hl7.org/fhir/uv/v2mappings/message-oru-r01-to-bundle"], "activity": {"coding": [{"code": "v2-FHIR transformation"}]}, "agent": [{"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/provenance-participant-type", "code": "assembler"}]}, "who": {"reference": "Organization/1714076050454162000.ef2f189e-335e-4716-bfff-2c77c696b9f6"}}]}}, {"fullUrl": "Organization/1714076050454162000.ef2f189e-335e-4716-bfff-2c77c696b9f6", "resource": {"resourceType": "Organization", "id": "1714076050454162000.ef2f189e-335e-4716-bfff-2c77c696b9f6", "identifier": [{"value": "CDC PRIME - Atlanta"}, {"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0301"}]}, "system": "urn:ietf:rfc:3986", "value": "2.16.840.1.114222.4.1.237821"}]}}, {"fullUrl": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a", "resource": {"resourceType": "Patient", "id": "1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/pid-patient", "extension": [{"url": "PID.8", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}], "code": "F"}]}}, {"url": "PID.30", "valueString": "N"}]}, {"url": "http://ibm.com/fhir/cdm/StructureDefinition/local-race-cd", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70005"}], "system": "http://terminology.hl7.org/CodeSystem/v3-Race", "version": "2.5.1", "code": "2106-3", "display": "White"}]}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/ethnic-group", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70189"}], "system": "http://terminology.hl7.org/CodeSystem/v2-0189", "code": "U", "display": "Unknown"}]}}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cx-identifier", "extension": [{"url": "CX.5", "valueString": "PI"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "PID.3"}], "type": {"coding": [{"code": "PI"}]}, "value": "2a14112c-ece1-4f82-915c-7b3a8d152eda", "assigner": {"reference": "Organization/1714076050460441000.2cea5a01-6238-42db-974a-d3dd4ccadf06"}}], "name": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xpn-human-name", "extension": [{"url": "XPN.2", "valueString": "Kareem"}, {"url": "XPN.3", "valueString": "Millie"}, {"url": "XPN.7", "valueString": "L"}]}], "use": "official", "family": "Buckridge", "given": ["Kareem", "Millie"]}], "telecom": [{"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "211"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "2240784"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.1", "valueString": "7275555555:1:"}, {"url": "XTN.2", "valueString": "PRN"}, {"url": "XTN.4", "valueString": "roscoe.wilkinson@email.com"}, {"url": "XTN.7", "valueString": "2240784"}]}], "system": "email", "use": "home"}], "gender": "female", "birthDate": "1958-08-10", "_birthDate": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "19580810"}]}, "deceasedBoolean": false, "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "688 Leighann Inlet"}]}]}], "line": ["688 Leighann Inlet"], "city": "South Rodneychester", "district": "48077", "state": "TX", "postalCode": "67071"}]}}, {"fullUrl": "Organization/1714076050460441000.2cea5a01-6238-42db-974a-d3dd4ccadf06", "resource": {"resourceType": "Organization", "id": "1714076050460441000.2cea5a01-6238-42db-974a-d3dd4ccadf06", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "HD.1"}], "value": "Avante at Ormond Beach"}]}}, {"fullUrl": "Provenance/1714076050477224000.1628017b-94e5-4e4c-bb2e-251383476529", "resource": {"resourceType": "Provenance", "id": "1714076050477224000.1628017b-94e5-4e4c-bb2e-251383476529", "target": [{"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}], "recorded": "2024-04-25T16:14:10Z", "activity": {"coding": [{"system": "https://terminology.hl7.org/CodeSystem/v3-DataOperation", "code": "UPDATE"}]}}}, {"fullUrl": "Observation/1714076050479965000.91c31627-78bd-4f0e-83fc-b7749d09d05d", "resource": {"resourceType": "Observation", "id": "1714076050479965000.91c31627-78bd-4f0e-83fc-b7749d09d05d", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/analysis-date-time", "valueDateTime": "2021-02-09T00:00:00-06:00", "_valueDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}, {"url": "OBX.17", "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "99ELR"}], "code": "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"}]}}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "performer": [{"reference": "Organization/1714076050480881000.76426968-0f15-47ed-9cec-f54aacf336dc"}], "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "code": "260415000", "display": "Not detected"}]}, "interpretation": [{"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70078"}], "code": "N", "display": "Normal (applies to non-numeric results)"}]}], "method": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "99ELR"}], "code": "CareStart COVID-19 Antigen test_Access Bio, Inc._EUA"}]}}}, {"fullUrl": "Organization/1714076050480881000.76426968-0f15-47ed-9cec-f54aacf336dc", "resource": {"resourceType": "Organization", "id": "1714076050480881000.76426968-0f15-47ed-9cec-f54aacf336dc", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization", "extension": [{"url": "XON.10", "valueString": "10D0876999"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "OBX.25"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CLIA"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.4.7"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}], "value": "10D0876999"}], "name": "Avante at Ormond Beach", "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}]}}, {"fullUrl": "Observation/1714076050483565000.c539a463-c7a5-41c8-ae9c-9841735124f3", "resource": {"resourceType": "Observation", "id": "1714076050483565000.c539a463-c7a5-41c8-ae9c-9841735124f3", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95418-0", "display": "Whether patient is employed in a healthcare setting"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "Y", "display": "Yes"}]}}}, {"fullUrl": "Observation/1714076050486065000.616b4d6e-faf1-4e12-a255-d8972c32b1d9", "resource": {"resourceType": "Observation", "id": "1714076050486065000.616b4d6e-faf1-4e12-a255-d8972c32b1d9", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95417-2", "display": "First test for condition of interest"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "Y", "display": "Yes"}]}}}, {"fullUrl": "Observation/1714076050487946000.e957be9d-b4fd-4c17-8b44-dde8bf20df85", "resource": {"resourceType": "Observation", "id": "1714076050487946000.e957be9d-b4fd-4c17-8b44-dde8bf20df85", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation", "extension": [{"url": "OBX.2", "valueId": "CWE"}, {"url": "OBX.11", "valueString": "F"}]}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "95421-4", "display": "Resides in a congregate care setting"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "effectiveDateTime": "2021-02-09T00:00:00-06:00", "_effectiveDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "valueCodeableConcept": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "HL70136"}], "code": "N", "display": "No"}]}}}, {"fullUrl": "Specimen/1714076050635518000.e5c47b4d-4404-4edd-bc07-142bfc0e90c5", "resource": {"resourceType": "Specimen", "id": "1714076050635518000.e5c47b4d-4404-4edd-bc07-142bfc0e90c5", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment", "valueString": "OBR"}]}}, {"fullUrl": "Specimen/1714076050637369000.7c579064-c691-42a7-89d4-02a2fa00d924", "resource": {"resourceType": "Specimen", "id": "1714076050637369000.7c579064-c691-42a7-89d4-02a2fa00d924", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment", "valueString": "SPM"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Component", "valueString": "SPM.2.1"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PGN"}]}, "value": "0cba76f5-35e0-4a28-803a-2f31308aae9b"}], "type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "code": "258500001", "display": "Nasopharyngeal swab"}]}, "receivedTime": "2021-02-09T00:00:00-06:00", "_receivedTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "collection": {"collectedDateTime": "2021-02-09T00:00:00-06:00", "_collectedDateTime": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "bodySite": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "SCT"}], "system": "http://snomed.info/sct", "version": "2020-09-01", "code": "71836000", "display": "Nasopharyngeal structure (body structure)"}]}}}}, {"fullUrl": "ServiceRequest/1714076050647840000.cb7f08b5-f042-4af2-99ef-93df2701ae8c", "resource": {"resourceType": "ServiceRequest", "id": "1714076050647840000.cb7f08b5-f042-4af2-99ef-93df2701ae8c", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/business-event", "valueCode": "RE"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/orc-common-order", "extension": [{"url": "orc-21-ordering-facility-name", "valueReference": {"reference": "Organization/1714076050642630000.15f993ed-02f8-473f-8b77-95bca4c97f3a"}}, {"url": "orc-22-ordering-facility-address", "valueAddress": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}}, {"url": "orc-24-ordering-provider-address", "valueAddress": {"postalCode": "32174"}}, {"url": "orc-12-ordering-provider", "valueReference": {"reference": "Practitioner/1714076050643844000.3dad2a39-2e39-4120-9991-919e24397bb8"}}, {"url": "ORC.15", "valueString": "20210209"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/obr-observation-request", "extension": [{"url": "OBR.2", "valueIdentifier": {"value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}}, {"url": "OBR.3", "valueIdentifier": {"value": "0cba76f5-35e0-4a28-803a-2f31308aae9b"}}, {"url": "OBR.22", "valueString": "202102090000-0600"}, {"url": "OBR.16", "valueReference": {"reference": "Practitioner/1714076050645896000.f58ffd44-b08f-4d07-9273-d8441c8130ec"}}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number", "valueContactPoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "386"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "6825220"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.7", "valueString": "6825220"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "OBR.17"}], "_system": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "use": "work"}}]}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.2"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PLAC"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.3"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "FILL"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}], "status": "unknown", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "requester": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number", "valueContactPoint": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "386"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "6825220"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.7", "valueString": "6825220"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.14"}], "_system": {"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/data-absent-reason", "valueCode": "unknown"}]}, "use": "work"}}], "reference": "PractitionerRole/1714076050638584000.7d2a4493-16cf-4f9d-896f-731d2aea7624"}}}, {"fullUrl": "Practitioner/1714076050639750000.554bf0ef-b2be-4fbc-bc37-c67a216c1f14", "resource": {"resourceType": "Practitioner", "id": "1714076050639750000.554bf0ef-b2be-4fbc-bc37-c67a216c1f14", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.12"}], "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "NPI"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "urn:oid:2.16.840.1.113883.4.6"}], "type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}], "address": [{"postalCode": "32174"}]}}, {"fullUrl": "Organization/1714076050640767000.dc66770b-e134-4d0e-8989-70c12c60fc7a", "resource": {"resourceType": "Organization", "id": "1714076050640767000.dc66770b-e134-4d0e-8989-70c12c60fc7a", "name": "Avante at Ormond Beach", "telecom": [{"extension": [{"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-country", "valueString": "1"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-area", "valueString": "407"}, {"url": "http://hl7.org/fhir/StructureDefinition/contactpoint-local", "valueString": "7397506"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point", "extension": [{"url": "XTN.2", "valueString": "WPN"}, {"url": "XTN.4", "valueString": "jbrush@avantecenters.com"}, {"url": "XTN.7", "valueString": "7397506"}]}], "system": "email", "use": "work"}], "address": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xad-address", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/sad-address-line", "extension": [{"url": "SAD.1", "valueString": "170 North King Road"}]}]}], "line": ["170 North King Road"], "city": "Ormond Beach", "district": "12127", "state": "FL", "postalCode": "32174"}]}}, {"fullUrl": "PractitionerRole/1714076050638584000.7d2a4493-16cf-4f9d-896f-731d2aea7624", "resource": {"resourceType": "PractitionerRole", "id": "1714076050638584000.7d2a4493-16cf-4f9d-896f-731d2aea7624", "practitioner": {"reference": "Practitioner/1714076050639750000.554bf0ef-b2be-4fbc-bc37-c67a216c1f14"}, "organization": {"reference": "Organization/1714076050640767000.dc66770b-e134-4d0e-8989-70c12c60fc7a"}}}, {"fullUrl": "Organization/1714076050642630000.15f993ed-02f8-473f-8b77-95bca4c97f3a", "resource": {"resourceType": "Organization", "id": "1714076050642630000.15f993ed-02f8-473f-8b77-95bca4c97f3a", "name": "Avante at Ormond Beach"}}, {"fullUrl": "Practitioner/1714076050643844000.3dad2a39-2e39-4120-9991-919e24397bb8", "resource": {"resourceType": "Practitioner", "id": "1714076050643844000.3dad2a39-2e39-4120-9991-919e24397bb8", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}], "identifier": [{"type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}]}}, {"fullUrl": "Practitioner/1714076050645896000.f58ffd44-b08f-4d07-9273-d8441c8130ec", "resource": {"resourceType": "Practitioner", "id": "1714076050645896000.f58ffd44-b08f-4d07-9273-d8441c8130ec", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority", "extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id", "valueString": "CMS"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id", "valueString": "2.16.840.1.113883.3.249"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type", "valueCode": "ISO"}]}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/xcn-practitioner", "extension": [{"url": "XCN.3", "valueString": "Husam"}]}], "identifier": [{"type": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/codeable-concept-id", "valueBoolean": true}], "code": "NPI"}]}, "system": "CMS", "value": "1629082607"}], "name": [{"family": "Eddin", "given": ["Husam"]}]}}, {"fullUrl": "DiagnosticReport/1714076050653185000.919d3a83-8196-4559-9b09-82223811a264", "resource": {"resourceType": "DiagnosticReport", "id": "1714076050653185000.919d3a83-8196-4559-9b09-82223811a264", "identifier": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field", "valueString": "ORC.2"}], "type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "PLAC"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}, {"type": {"coding": [{"system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "FILL"}]}, "value": "73a6e9bd-aaec-418e-813a-0ad33366ca85"}], "basedOn": [{"reference": "ServiceRequest/1714076050647840000.cb7f08b5-f042-4af2-99ef-93df2701ae8c"}], "status": "final", "code": {"coding": [{"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding", "valueString": "coding"}, {"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system", "valueString": "LN"}], "system": "http://loinc.org", "code": "94558-4", "display": "SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]}, "subject": {"reference": "Patient/1714076050474891000.93554b06-037d-423d-a6d9-acff906d8d4a"}, "effectivePeriod": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valuePeriod": {"start": "2021-02-09T00:00:00-06:00", "_start": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "end": "2021-02-09T00:00:00-06:00", "_end": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}}], "start": "2021-02-09T00:00:00-06:00", "_start": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "end": "2021-02-09T00:00:00-06:00", "_end": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}}, "issued": "2021-02-09T00:00:00-06:00", "_issued": {"extension": [{"url": "https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time", "valueString": "202102090000-0600"}]}, "specimen": [{"reference": "Specimen/1714076050637369000.7c579064-c691-42a7-89d4-02a2fa00d924"}, {"reference": "Specimen/1714076050635518000.e5c47b4d-4404-4edd-bc07-142bfc0e90c5"}], "result": [{"reference": "Observation/1714076050479965000.91c31627-78bd-4f0e-83fc-b7749d09d05d"}, {"reference": "Observation/1714076050483565000.c539a463-c7a5-41c8-ae9c-9841735124f3"}, {"reference": "Observation/1714076050486065000.616b4d6e-faf1-4e12-a255-d8972c32b1d9"}, {"reference": "Observation/1714076050487946000.e957be9d-b4fd-4c17-8b44-dde8bf20df85"}]}}]}"""

// The encoding ^~\&#! make this message not parseable
@Suppress("ktlint:standard:max-line-length")
const val badEncodingHL7Record =
    """MSH|^~\&#!|CDC PRIME - Atlanta, Georgia (Dekalb)^2.16.840.1.114222.4.1.237821^ISO|Avante at Ormond Beach^10D0876999^CLIA|PRIME_DOH|Prime ReportStream|20210210170737||ORU^R01^ORU_R01|371784|P|2.5.1|||NE|NE|USA||||PHLabReportNoAck^ELR_Receiver^2.16.840.1.113883.9.99^ISO
SFT|Centers for Disease Control and Prevention|0.1-SNAPSHOT|PRIME ReportStream|0.1-SNAPSHOT||20210210
PID|1||2a14112c-ece1-4f82-915c-7b3a8d152eda^^^Avante at Ormond Beach^PI||Buckridge^Kareem^Millie^^^^L||19580810|F||2106-3^White^HL70005^^^^2.5.1|688 Leighann Inlet^^South Rodneychester^TX^67071^^^^48077||7275555555:1:^PRN^^roscoe.wilkinson@email.com^1^211^2240784|||||||||U^Unknown^HL70189||||||||N
ORC|RE|73a6e9bd-aaec-418e-813a-0ad33366ca85|73a6e9bd-aaec-418e-813a-0ad33366ca85|||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI||^WPN^^^1^386^6825220|20210209||||||Avante at Ormond Beach|170 North King Road^^Ormond Beach^FL^32174^^^^12127|^WPN^^jbrush@avantecenters.com^1^407^7397506|^^^^32174
OBR|1|73a6e9bd-aaec-418e-813a-0ad33366ca85|0cba76f5-35e0-4a28-803a-2f31308aae9b|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN|||202102090000-0600|202102090000-0600||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI|^WPN^^^1^386^6825220|||||202102090000-0600|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN||260415000^Not detected^SCT|||N^Normal (applies to non-numeric results)^HL70078|||F|||202102090000-0600|||CareStart COVID-19 Antigen test_Access Bio, Inc._EUA^^99ELR||202102090000-0600||||Avante at Ormond Beach^^^^^CLIA&2.16.840.1.113883.4.7&ISO^^^^10D0876999^CLIA|170 North King Road^^Ormond Beach^FL^32174^^^^12127
OBX|2|CWE|95418-0^Whether patient is employed in a healthcare setting^LN^^^^2.69||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|3|CWE|95417-2^First test for condition of interest^LN^^^^2.69||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|4|CWE|95421-4^Resides in a congregate care setting^LN^^^^2.69||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|5|CWE|95419-8^Has symptoms related to condition of interest^LN^^^^2.69||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
SPM|1|0cba76f5-35e0-4a28-803a-2f31308aae9b||258500001^Nasopharyngeal swab^SCT||||71836000^Nasopharyngeal structure (body structure)^SCT^^^^2020-09-01|||||||||202102090000-0600|202102090000-0600"""

// The missing | MSH^~\& make this message not parseable
@Suppress("ktlint:standard:max-line-length")
const val unparseableHL7Record =
    """MSH^~\&|CDC PRIME - Atlanta, Georgia (Dekalb)^2.16.840.1.114222.4.1.237821^ISO|Avante at Ormond Beach^10D0876999^CLIA|PRIME_DOH|Prime ReportStream|20210210170737||ORU^R01^ORU_R01|371784|P|2.5.1|||NE|NE|USA||||PHLabReportNoAck^ELR_Receiver^2.16.840.1.113883.9.99^ISO
SFT|Centers for Disease Control and Prevention|0.1-SNAPSHOT|PRIME ReportStream|0.1-SNAPSHOT||20210210
PID|1||2a14112c-ece1-4f82-915c-7b3a8d152eda^^^Avante at Ormond Beach^PI||Buckridge^Kareem^Millie^^^^L||19580810|F||2106-3^White^HL70005^^^^2.5.1|688 Leighann Inlet^^South Rodneychester^TX^67071^^^^48077||7275555555:1:^PRN^^roscoe.wilkinson@email.com^1^211^2240784|||||||||U^Unknown^HL70189||||||||N
ORC|RE|73a6e9bd-aaec-418e-813a-0ad33366ca85^6^7^8&F^9|73a6e9bd-aaec-418e-813a-0ad33366ca85|||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI||^WPN^^^1^386^6825220|20210209||||||Avante at Ormond Beach|170 North King Road^^Ormond Beach^FL^32174^^^^12127|^WPN^^jbrush@avantecenters.com^1^407^7397506|^^^^32174
OBR|1|73a6e9bd-aaec-418e-813a-0ad33366ca85|0cba76f5-35e0-4a28-803a-2f31308aae9b|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN|||202102090000-0600|202102090000-0600||||||||1629082607^Eddin^Husam^^^^^^CMS&2.16.840.1.113883.3.249&ISO^^^^NPI|^WPN^^^1^386^6825220|||||202102090000-0600|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN||260415000^Not detected^SCT|||N^Normal (applies to non-numeric results)^HL70078|||F|||202102090000-0600|||CareStart COVID-19 Antigen test_Access Bio, Inc._EUA^^99ELR||202102090000-0600||||Avante at Ormond Beach^^^^^CLIA&2.16.840.1.113883.4.7&ISO^^^^10D0876999^CLIA|170 North King Road^^Ormond Beach^FL^32174^^^^12127
OBX|2|CWE|95418-0^Whether patient is employed in a healthcare setting^LN^^^^2.69||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|3|CWE|95417-2^First test for condition of interest^LN^^^^2.69||Y^Yes^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|4|CWE|95421-4^Resides in a congregate care setting^LN^^^^2.69||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
OBX|5|CWE|95419-8^Has symptoms related to condition of interest^LN^^^^2.69||N^No^HL70136||||||F|||202102090000-0600|||||||||||||||QST
SPM|1|0cba76f5-35e0-4a28-803a-2f31308aae9b||258500001^Nasopharyngeal swab^SCT||||71836000^Nasopharyngeal structure (body structure)^SCT^^^^2020-09-01|||||||||202102090000-0600|202102090000-0600"""

@Suppress("ktlint:standard:max-line-length")
const val validRadxMarsHL7Message =
    """MSH|^~\&|MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|CAREEVOLUTION^00Z0000024^CLIA|AIMS.INTEGRATION.PRD^2.16.840.1.114222.4.3.15.1^ISO|AIMS.PLATFORM^2.16.840.1.114222.4.1.217446^ISO|20240403205305+0000||ORU^R01^ORU_R01|20240403205305_dba7572cc6334f1ea0744c5f235c823e|P|2.5.1|||NE|NE|||||PHLabReport-NoAck^ELR251R1_Rcvr_Prof^2.16.840.1.113883.9.11^ISO
SFT|CAREEVOLUTION|2022|MMTC.PROD|16498||20240402
PID|1||8be6fa3710374dcebe0174e0fd5a1a7c^^^MMTC.PROD&2.16.840.1.113883.3.8589.4.2.106.1&ISO^PI||^^^^^^~^^^^^^||||||^^^^02139^USA||^^^^^111^1111111
ORC|RE||^MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|||||||||^^||^^^^^^|||||||SA.OTCSelfReport|^^^^02139^^^^|^^^^^^
OBR|1||^MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN^^^^2.71|||20240403120000-0400|||||||||^^|^^^^^^|||||20240403120000-0400|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN^^^^2.71||260373001^Detected^SCT^^^^20200901||||||F||||00Z0000042||BinaxNOW COVID-19 Antigen Self Test_Abbott Diagnostics Scarborough, Inc._EUA^^99ELR^^^^Vunknown||20240403120000-0400||||SA.OTCSelfReport^^^^^&2.16.840.1.113883.3.8589.4.1.152&ISO^XX^^^00Z0000042|
NTE|1|L|Note
OBX|2|NM|35659-2^Age at specimen collection^LN^^^^2.71||24|a^year^UCUM^^^^2.1|||||F||||00Z0000042||||||||SA.OTCSelfReport^^^^^&2.16.840.1.113883.3.8589.4.1.152&ISO^XX^^^00Z0000042||||||QST
SPM|1|^dba7572cc6334f1ea0744c5f235c823e&MMTC.PROD&2.16.840.1.113883.3.8589.4.2.106.1&ISO||697989009^Anterior nares swab^SCT^^^^20200901|||||||||||||20240403120000-0400|20240403120000-0400"""

@Suppress("ktlint:standard:max-line-length")
const val validRadxMarsHL7MessageConverted =
    """{"resourceType":"Bundle","id":"1716963321626342000.ad0002cd-565b-4fe0-a13b-4e57ccf22d8d","meta":{"lastUpdated":"2024-05-29T02:15:21.629-04:00"},"identifier":{"system":"https://reportstream.cdc.gov/prime-router","value":"20240403205305_dba7572cc6334f1ea0744c5f235c823e"},"type":"message","timestamp":"2024-04-03T16:53:05.000-04:00","entry":[{"fullUrl":"MessageHeader/df373c48-bfb2-36b0-b63c-5be13bc5d051","resource":{"resourceType":"MessageHeader","id":"df373c48-bfb2-36b0-b63c-5be13bc5d051","meta":{"tag":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0103","code":"P"}]},"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/msh-message-header","extension":[{"url":"MSH.7","valueString":"20240403205305+0000"},{"url":"MSH.15","valueString":"NE"},{"url":"MSH.16","valueString":"NE"},{"url":"MSH.21","valueIdentifier":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"ELR251R1_Rcvr_Prof"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.9.11"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}],"value":"PHLabReport-NoAck"}}]}],"eventCoding":{"system":"http://terminology.hl7.org/CodeSystem/v2-0003","code":"R01","display":"ORU^R01^ORU_R01"},"destination":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.114222.4.3.15.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString":"ISO"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"MSH.5"}],"name":"AIMS.INTEGRATION.PRD","endpoint":"urn:oid:2.16.840.1.114222.4.3.15.1","receiver":{"reference":"Organization/1716963321703057000.7ada69dd-194b-4167-9ffa-4770b9070f80"}}],"sender":{"reference":"Organization/1716963321679447000.6f958e42-f5c8-4f96-bcb3-9a784e6473f8"},"source":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString":"ISO"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"MSH.3"}],"software":"MMTC.PROD","version":"2022","endpoint":"urn:oid:2.16.840.1.113883.3.8589.4.2.106.1"}}},{"fullUrl":"Organization/1716963321679447000.6f958e42-f5c8-4f96-bcb3-9a784e6473f8","resource":{"resourceType":"Organization","id":"1716963321679447000.6f958e42-f5c8-4f96-bcb3-9a784e6473f8","identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.1"}],"value":"CAREEVOLUTION"},{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.2,HD.3"}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0301","code":"CLIA"}]},"value":"00Z0000024"}]}},{"fullUrl":"Organization/1716963321703057000.7ada69dd-194b-4167-9ffa-4770b9070f80","resource":{"resourceType":"Organization","id":"1716963321703057000.7ada69dd-194b-4167-9ffa-4770b9070f80","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"MSH.6"}],"identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.1"}],"value":"AIMS.PLATFORM"},{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.2,HD.3"}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0301","code":"ISO"}]},"system":"urn:ietf:rfc:3986","value":"2.16.840.1.114222.4.1.217446"}]}},{"fullUrl":"Provenance/1716963321755113000.883fae56-3831-4510-bc2d-8310b0b8f456","resource":{"resourceType":"Provenance","id":"1716963321755113000.883fae56-3831-4510-bc2d-8310b0b8f456","target":[{"reference":"MessageHeader/df373c48-bfb2-36b0-b63c-5be13bc5d051"},{"reference":"DiagnosticReport/1716963321952286000.0a25735a-ab81-4733-885e-2cdbd0b41a4f"}],"recorded":"2024-04-03T20:53:05Z","activity":{"coding":[{"display":"ORU^R01^ORU_R01"}]},"agent":[{"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/provenance-participant-type","code":"author"}]},"who":{"reference":"Organization/1716963321753887000.01d088d5-e356-4134-9516-ad9b85a50aab"}}],"entity":[{"role":"source","what":{"reference":"Device/1716963321759558000.b4d9f2ef-393e-4999-834b-6a7ea13e9d83"}}]}},{"fullUrl":"Organization/1716963321753887000.01d088d5-e356-4134-9516-ad9b85a50aab","resource":{"resourceType":"Organization","id":"1716963321753887000.01d088d5-e356-4134-9516-ad9b85a50aab","identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.1"}],"value":"CAREEVOLUTION"},{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"HD.2,HD.3"}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0301","code":"CLIA"}]},"value":"00Z0000024"}]}},{"fullUrl":"Organization/1716963321759058000.2ca93aed-327e-4664-818b-7e46a8c0be2a","resource":{"resourceType":"Organization","id":"1716963321759058000.2ca93aed-327e-4664-818b-7e46a8c0be2a","name":"CAREEVOLUTION"}},{"fullUrl":"Device/1716963321759558000.b4d9f2ef-393e-4999-834b-6a7ea13e9d83","resource":{"resourceType":"Device","id":"1716963321759558000.b4d9f2ef-393e-4999-834b-6a7ea13e9d83","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/software-vendor-org","valueReference":{"reference":"Organization/1716963321759058000.2ca93aed-327e-4664-818b-7e46a8c0be2a"}}],"manufacturer":"CAREEVOLUTION","deviceName":[{"name":"MMTC.PROD","type":"manufacturer-name"}],"modelNumber":"16498","version":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/software-install-date","valueDateTime":"2024-04-02","_valueDateTime":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240402"}]}}],"value":"2022"}]}},{"fullUrl":"Provenance/1716963321767352000.f8200039-e499-41f1-87da-8f50b36b9607","resource":{"resourceType":"Provenance","id":"1716963321767352000.f8200039-e499-41f1-87da-8f50b36b9607","recorded":"2024-05-29T02:15:21Z","policy":["http://hl7.org/fhir/uv/v2mappings/message-oru-r01-to-bundle"],"activity":{"coding":[{"code":"v2-FHIR transformation"}]},"agent":[{"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/provenance-participant-type","code":"assembler"}]},"who":{"reference":"Organization/1716963321766971000.6b2d25c5-3065-4f0a-b890-3cc50f00b079"}}]}},{"fullUrl":"Organization/1716963321766971000.6b2d25c5-3065-4f0a-b890-3cc50f00b079","resource":{"resourceType":"Organization","id":"1716963321766971000.6b2d25c5-3065-4f0a-b890-3cc50f00b079","identifier":[{"value":"CDC PRIME - Atlanta"},{"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0301"}]},"system":"urn:ietf:rfc:3986","value":"2.16.840.1.114222.4.1.237821"}]}},{"fullUrl":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb","resource":{"resourceType":"Patient","id":"1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb","identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cx-identifier","extension":[{"url":"CX.5","valueString":"PI"}]},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"PID.3"}],"type":{"coding":[{"code":"PI"}]},"system":"MMTC.PROD","_system":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString":"ISO"}]},"value":"8be6fa3710374dcebe0174e0fd5a1a7c"}],"name":[{},{}],"telecom":[{"extension":[{"url":"http://hl7.org/fhir/StructureDefinition/contactpoint-area","valueString":"111"},{"url":"http://hl7.org/fhir/StructureDefinition/contactpoint-local","valueString":"1111111"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/xtn-contact-point","extension":[{"url":"XTN.7","valueString":"1111111"}]}],"_system":{"extension":[{"url":"http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode":"unknown"}]},"use":"home"}],"address":[{"postalCode":"02139","country":"USA"}]}},{"fullUrl":"Provenance/1716963321787217000.8af56b90-52b0-4a3b-a54b-6062b4a09b1a","resource":{"resourceType":"Provenance","id":"1716963321787217000.8af56b90-52b0-4a3b-a54b-6062b4a09b1a","target":[{"reference":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb"}],"recorded":"2024-05-29T02:15:21Z","activity":{"coding":[{"system":"https://terminology.hl7.org/CodeSystem/v3-DataOperation","code":"UPDATE"}]}}},{"fullUrl":"Observation/1716963321790180000.03e9d7f1-b6b7-434a-92b8-5f3932fd2651","resource":{"resourceType":"Observation","id":"1716963321790180000.03e9d7f1-b6b7-434a-92b8-5f3932fd2651","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/analysis-date-time","valueDateTime":"2024-04-03T12:00:00-04:00","_valueDateTime":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240403120000-0400"}]}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension":[{"url":"OBX.2","valueId":"CWE"},{"url":"OBX.11","valueString":"F"},{"url":"OBX.17","valueCodeableConcept":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"99ELR"}],"version":"Vunknown","code":"BinaxNOW COVID-19 Antigen Self Test_Abbott Diagnostics Scarborough, Inc._EUA"}]}}]}],"status":"final","code":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"LN"}],"system":"http://loinc.org","version":"2.71","code":"94558-4","display":"SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]},"subject":{"reference":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb"},"performer":[{"reference":"Organization/1716963321791105000.13cc94cd-bc79-4612-b111-6e6b341e37ae"},{"reference":"Organization/1716963321792057000.6a534389-e64e-472a-b2ce-e8273f187c11"}],"valueCodeableConcept":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"SCT"}],"system":"http://snomed.info/sct","version":"20200901","code":"260373001","display":"Detected"}]},"note":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/nte-annotation","extension":[{"url":"NTE.2","valueId":"L"}]},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/note-comment","valueId":"Note"}],"text":"Note"}],"method":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"99ELR"}],"version":"Vunknown","code":"BinaxNOW COVID-19 Antigen Self Test_Abbott Diagnostics Scarborough, Inc._EUA"}]}}},{"fullUrl":"Organization/1716963321791105000.13cc94cd-bc79-4612-b111-6e6b341e37ae","resource":{"resourceType":"Organization","id":"1716963321791105000.13cc94cd-bc79-4612-b111-6e6b341e37ae","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-organization","valueCodeableConcept":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"}],"code":"00Z0000042"}]}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"OBX.15"}],"identifier":[{"value":"00Z0000042"}]}},{"fullUrl":"Organization/1716963321792057000.6a534389-e64e-472a-b2ce-e8273f187c11","resource":{"resourceType":"Organization","id":"1716963321792057000.6a534389-e64e-472a-b2ce-e8273f187c11","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization","extension":[{"url":"XON.10","valueString":"00Z0000042"}]},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"OBX.25"}],"identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.1.152"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}],"type":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/code-index-name","valueString":"identifier"}],"system":"http://terminology.hl7.org/CodeSystem/v2-0203","code":"XX"}]},"value":"00Z0000042"}],"name":"SA.OTCSelfReport"}},{"fullUrl":"Observation/1716963321797917000.5b42c2f7-13a9-49af-a286-afdd03547758","resource":{"resourceType":"Observation","id":"1716963321797917000.5b42c2f7-13a9-49af-a286-afdd03547758","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/obx-observation","extension":[{"url":"OBX.2","valueId":"NM"},{"url":"OBX.6","valueCodeableConcept":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"UCUM"}],"system":"http://unitsofmeasure.org","version":"2.1","code":"a","display":"year"}]}},{"url":"OBX.29","valueId":"QST"},{"url":"OBX.11","valueString":"F"}]}],"status":"final","code":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"LN"}],"system":"http://loinc.org","version":"2.71","code":"35659-2","display":"Age at specimen collection"}]},"subject":{"reference":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb"},"performer":[{"reference":"Organization/1716963321798554000.16885452-ec5f-4443-b364-57854b14a1fe"},{"reference":"Organization/1716963321799389000.2311ff70-7ff8-4566-b25d-fa7a9f690e6c"}],"valueQuantity":{"value":24,"unit":"year","system":"UCUM","code":"a"}}},{"fullUrl":"Organization/1716963321798554000.16885452-ec5f-4443-b364-57854b14a1fe","resource":{"resourceType":"Organization","id":"1716963321798554000.16885452-ec5f-4443-b364-57854b14a1fe","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-organization","valueCodeableConcept":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"}],"code":"00Z0000042"}]}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"OBX.15"}],"identifier":[{"value":"00Z0000042"}]}},{"fullUrl":"Organization/1716963321799389000.2311ff70-7ff8-4566-b25d-fa7a9f690e6c","resource":{"resourceType":"Organization","id":"1716963321799389000.2311ff70-7ff8-4566-b25d-fa7a9f690e6c","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/xon-organization","extension":[{"url":"XON.10","valueString":"00Z0000042"}]},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"OBX.25"}],"identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.1.152"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}],"type":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/code-index-name","valueString":"identifier"}],"system":"http://terminology.hl7.org/CodeSystem/v2-0203","code":"XX"}]},"value":"00Z0000042"}],"name":"SA.OTCSelfReport"}},{"fullUrl":"Specimen/1716963321931116000.db4444cb-f611-4140-98ae-647e6dcd8abd","resource":{"resourceType":"Specimen","id":"1716963321931116000.db4444cb-f611-4140-98ae-647e6dcd8abd","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString":"OBR"}]}},{"fullUrl":"Specimen/1716963321934730000.344a3439-03ef-457e-9a03-31888fd5e71d","resource":{"resourceType":"Specimen","id":"1716963321934730000.344a3439-03ef-457e-9a03-31888fd5e71d","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Segment","valueString":"SPM"}],"identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueString":"ISO"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Component","valueString":"SPM.2.2"}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0203","code":"FGN"}]},"value":"dba7572cc6334f1ea0744c5f235c823e"}],"type":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"SCT"}],"system":"http://snomed.info/sct","version":"20200901","code":"697989009","display":"Anterior nares swab"}]},"receivedTime":"2024-04-03T12:00:00-04:00","_receivedTime":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240403120000-0400"}]},"collection":{"collectedDateTime":"2024-04-03T12:00:00-04:00","_collectedDateTime":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240403120000-0400"}]}}}},{"fullUrl":"ServiceRequest/1716963321948328000.ce7441b9-928e-4a8b-a042-b990d8e692dc","resource":{"resourceType":"ServiceRequest","id":"1716963321948328000.ce7441b9-928e-4a8b-a042-b990d8e692dc","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/business-event","valueCode":"RE"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/orc-common-order","extension":[{"url":"orc-21-ordering-facility-name","valueReference":{"reference":"Organization/1716963321943661000.33f1430d-5e5d-415e-aebc-9b71ba6701f4"}},{"url":"orc-22-ordering-facility-address","valueAddress":{"postalCode":"02139"}},{"url":"orc-12-ordering-provider","valueReference":{"reference":"Practitioner/1716963321945206000.39222d9c-8e6f-49c5-b2bd-0abab2fe222c"}}]},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/obr-observation-request","extension":[{"url":"OBR.3","valueIdentifier":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}]}},{"url":"OBR.22","valueString":"20240403120000-0400"},{"url":"OBR.16","valueReference":{"reference":"Practitioner/1716963321946747000.8178ee47-a1fe-4e6f-a717-7688ce9206c6"}},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"OBR.17"}],"_system":{"extension":[{"url":"http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode":"unknown"}]}}}]}],"identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"ORC.3"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0203","code":"FILL"}]}}],"status":"unknown","code":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"LN"}],"system":"http://loinc.org","version":"2.71","code":"94558-4","display":"SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]},"subject":{"reference":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb"},"requester":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/callback-number","valueContactPoint":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"ORC.14"}],"_system":{"extension":[{"url":"http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode":"unknown"}]}}}],"reference":"PractitionerRole/1716963321936573000.e84bce8f-e381-4a24-a009-8e0077129c0d"}}},{"fullUrl":"Practitioner/1716963321938011000.52e857d6-726b-4af5-8ec1-0699e0aafb25","resource":{"resourceType":"Practitioner","id":"1716963321938011000.52e857d6-726b-4af5-8ec1-0699e0aafb25","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2Field","valueString":"ORC.12"}]}},{"fullUrl":"Organization/1716963321939763000.274f1f5d-97f9-4d1a-a237-ab64e1807111","resource":{"resourceType":"Organization","id":"1716963321939763000.274f1f5d-97f9-4d1a-a237-ab64e1807111","name":"SA.OTCSelfReport","telecom":[{"_system":{"extension":[{"url":"http://hl7.org/fhir/StructureDefinition/data-absent-reason","valueCode":"unknown"}]}}],"address":[{"postalCode":"02139"}]}},{"fullUrl":"PractitionerRole/1716963321936573000.e84bce8f-e381-4a24-a009-8e0077129c0d","resource":{"resourceType":"PractitionerRole","id":"1716963321936573000.e84bce8f-e381-4a24-a009-8e0077129c0d","practitioner":{"reference":"Practitioner/1716963321938011000.52e857d6-726b-4af5-8ec1-0699e0aafb25"},"organization":{"reference":"Organization/1716963321939763000.274f1f5d-97f9-4d1a-a237-ab64e1807111"}}},{"fullUrl":"Organization/1716963321943661000.33f1430d-5e5d-415e-aebc-9b71ba6701f4","resource":{"resourceType":"Organization","id":"1716963321943661000.33f1430d-5e5d-415e-aebc-9b71ba6701f4","name":"SA.OTCSelfReport"}},{"fullUrl":"Practitioner/1716963321945206000.39222d9c-8e6f-49c5-b2bd-0abab2fe222c","resource":{"resourceType":"Practitioner","id":"1716963321945206000.39222d9c-8e6f-49c5-b2bd-0abab2fe222c"}},{"fullUrl":"Practitioner/1716963321946747000.8178ee47-a1fe-4e6f-a717-7688ce9206c6","resource":{"resourceType":"Practitioner","id":"1716963321946747000.8178ee47-a1fe-4e6f-a717-7688ce9206c6"}},{"fullUrl":"DiagnosticReport/1716963321952286000.0a25735a-ab81-4733-885e-2cdbd0b41a4f","resource":{"resourceType":"DiagnosticReport","id":"1716963321952286000.0a25735a-ab81-4733-885e-2cdbd0b41a4f","identifier":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/assigning-authority","extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/namespace-id","valueString":"MMTC.PROD"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id","valueString":"2.16.840.1.113883.3.8589.4.2.106.1"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/universal-id-type","valueCode":"ISO"}]}],"type":{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0203","code":"FILL"}]}}],"basedOn":[{"reference":"ServiceRequest/1716963321948328000.ce7441b9-928e-4a8b-a042-b990d8e692dc"}],"status":"final","code":{"coding":[{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding","valueString":"coding"},{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/cwe-coding-system","valueString":"LN"}],"system":"http://loinc.org","version":"2.71","code":"94558-4","display":"SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay"}]},"subject":{"reference":"Patient/1716963321785674000.06e9d8fe-20b5-4470-b252-e77337f1dffb"},"effectiveDateTime":"2024-04-03T12:00:00-04:00","_effectiveDateTime":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240403120000-0400"}]},"issued":"2024-04-03T12:00:00-04:00","_issued":{"extension":[{"url":"https://reportstream.cdc.gov/fhir/StructureDefinition/hl7v2-date-time","valueString":"20240403120000-0400"}]},"specimen":[{"reference":"Specimen/1716963321934730000.344a3439-03ef-457e-9a03-31888fd5e71d"},{"reference":"Specimen/1716963321931116000.db4444cb-f611-4140-98ae-647e6dcd8abd"}],"result":[{"reference":"Observation/1716963321790180000.03e9d7f1-b6b7-434a-92b8-5f3932fd2651"},{"reference":"Observation/1716963321797917000.5b42c2f7-13a9-49af-a286-afdd03547758"}]}}]}"""

@Suppress("ktlint:standard:max-line-length")
const val invalidRadxMarsHL7Message =
    """MSH|^~\&|MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|CAREEVOLUTION^00Z0000024^CLIA|AIMS.INTEGRATION.PRD^2.16.840.1.114222.4.3.15.1^ISO|AIMS.PLATFORM^2.16.840.1.114222.4.1.217446^ISO|20240403205305+0000||ORU^R01^ORU_R01|20240403205305_dba7572cc6334f1ea0744c5f235c823e|P|2.5.1|||NE|NE|||||PHLabReport-NoAck^ELR251R1_Rcvr_Prof^2.16.840.1.113883.9.12^ISO
SFT|CAREEVOLUTION|2022|MMTC.PROD|16498||20240402
PID|1||8be6fa3710374dcebe0174e0fd5a1a7c^^^MMTC.PROD&2.16.840.1.113883.3.8589.4.2.106.1&ISO^PI||^^^^^^~^^^^^^||||||^^^^02139^USA||^^^^^111^1111111
ORC|RE||^MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|||||||||^^||^^^^^^|||||||SA.OTCSelfReport|^^^^02139^^^^|^^^^^^
OBR|1||^MMTC.PROD^2.16.840.1.113883.3.8589.4.2.106.1^ISO|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN^^^^2.71|||20240403120000|||||||||^^|^^^^^^|||||20240403120000|||F
OBX|1|CWE|94558-4^SARS-CoV-2 (COVID-19) Ag [Presence] in Respiratory specimen by Rapid immunoassay^LN^^^^2.71||260373001^Detected^SCT^^^^20200901||||||F||||00Z0000042||BinaxNOW COVID-19 Antigen Self Test_Abbott Diagnostics Scarborough, Inc._EUA^^99ELR^^^^Vunknown||20240403120000||||SA.OTCSelfReport^^^^^&2.16.840.1.113883.3.8589.4.1.152&ISO^XX^^^00Z0000042|
NTE|1|L|Note
OBX|2|NM|35659-2^Age at specimen collection^LN^^^^2.71||24|a^year^UCUM^^^^2.1|||||F||||00Z0000042||||||||SA.OTCSelfReport^^^^^&2.16.840.1.113883.3.8589.4.1.152&ISO^XX^^^00Z0000042||||||QST
SPM|1|^dba7572cc6334f1ea0744c5f235c823e&MMTC.PROD&2.16.840.1.113883.3.8589.4.2.106.1&ISO||697989009^Anterior nares swab^SCT^^^^20200901|||||||||||||20240403120000-0400|20240403120000-0400"""

object UniversalPipelineTestUtils {

    val hl7Sender = UniversalPipelineSender(
        "elr-hl7-sender",
        "phd",
        MimeFormat.HL7,
        CustomerStatus.ACTIVE,
        topic = Topic.FULL_ELR,
        schemaName = "classpath:/metadata/fhir_transforms/senders/test-sender-transform.yml"
    )
    val fhirSender = UniversalPipelineSender(
        "elr-fhir-sender",
        "phd",
        MimeFormat.FHIR,
        CustomerStatus.ACTIVE,
        topic = Topic.FULL_ELR,
        schemaName = "classpath:/metadata/fhir_transforms/senders/test-sender-transform.yml"
    )
    val hl7SenderWithNoTransform = UniversalPipelineSender(
        "hl7-elr-no-transform",
        "phd",
        MimeFormat.HL7,
        CustomerStatus.ACTIVE,
        topic = Topic.FULL_ELR,
    )
    val fhirSenderWithNoTransform = UniversalPipelineSender(
        "fhir-elr-no-transform",
        "phd",
        MimeFormat.HL7,
        CustomerStatus.ACTIVE,
        topic = Topic.FULL_ELR,
    )
    val fhirSenderWithSendOriginal = UniversalPipelineSender(
        "fhir-elr-send_original",
        "phd",
        MimeFormat.FHIR,
        CustomerStatus.ACTIVE,
        topic = Topic.ELR_ELIMS,
    )
    val senderWithValidation = UniversalPipelineSender(
        "marsotc-hl7-sender",
        "phd",
        MimeFormat.HL7,
        CustomerStatus.ACTIVE,
        topic = Topic.MARS_OTC_ELR,
    )
    val universalPipelineOrganization = DeepOrganization(
        "phd", "test", Organization.Jurisdiction.FEDERAL,
        senders = listOf(
            hl7Sender,
            fhirSender,
            hl7SenderWithNoTransform,
            fhirSenderWithNoTransform,
            senderWithValidation
        ),
        receivers = listOf(
            Receiver(
                "elr",
                "phd",
                Topic.TEST,
                CustomerStatus.INACTIVE,
                "one",
                timing = Receiver.Timing(numberPerDay = 1, maxReportCount = 1, whenEmpty = Receiver.WhenEmpty())
            ),
            Receiver(
                "elr2",
                "phd",
                Topic.FULL_ELR,
                CustomerStatus.ACTIVE,
                "classpath:/metadata/hl7_mapping/ORU_R01/ORU_R01-base.yml",
                timing = Receiver.Timing(numberPerDay = 1, maxReportCount = 1, whenEmpty = Receiver.WhenEmpty()),
                jurisdictionalFilter = listOf("true"),
                qualityFilter = listOf("true"),
                processingModeFilter = listOf("true"),
                format = MimeFormat.HL7,
            )
        ),
    )

    /**
     * fetch child reports associated with a [parent] report and ensure we find an [expected] number of children
     */
    fun fetchChildReports(
        parent: Report,
        txn: DataAccessTransaction,
        expected: Int? = null,
    ): List<ReportFile> {
        val itemLineages = DSL
            .using(txn)
            .select(ItemLineage.ITEM_LINEAGE.asterisk())
            .from(ItemLineage.ITEM_LINEAGE)
            .where(ItemLineage.ITEM_LINEAGE.PARENT_REPORT_ID.eq(parent.id))
            .fetchInto(gov.cdc.prime.router.azure.db.tables.pojos.ItemLineage::class.java)

        if (expected != null) {
            assertThat(itemLineages).hasSize(expected)
            assertThat(itemLineages.map { it.childIndex }).isEqualTo(MutableList(expected) { 1 })

            if (parent.itemCount > 1) {
                assertThat(itemLineages.map { it.parentIndex }).isEqualTo((1..expected).toList())
            } else {
                assertThat(itemLineages.map { it.parentIndex }).isEqualTo(MutableList(expected) { 1 })
            }
        }

        val reportLineages = DSL
            .using(txn)
            .select(ReportLineage.REPORT_LINEAGE.asterisk())
            .from(ReportLineage.REPORT_LINEAGE)
            .where(ReportLineage.REPORT_LINEAGE.PARENT_REPORT_ID.eq(parent.id))
            .fetchInto(gov.cdc.prime.router.azure.db.tables.pojos.ReportLineage::class.java)

        if (expected != null) {
            assertThat(reportLineages).hasSize(expected)
        }

        val childReportIds = reportLineages.map {
            it.childReportId
        }
        val reportFiles = DSL
            .using(txn)
            .select(gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE.asterisk())
            .from(gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE)
            .where(
                gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE.REPORT_ID.`in`(
                    childReportIds
                )
            )
            .fetchInto(ReportFile::class.java)
        if (expected != null) {
            assertThat(reportFiles).hasSize(expected)
        }
        assertThat(itemLineages).transform { lineages -> lineages.map { it.childReportId }.sorted() }
            .isEqualTo(reportFiles.map { it.reportId }.sorted())

        return reportFiles
    }

    // TODO: remove after route queue empty (see https://github.com/CDCgov/prime-reportstream/issues/15039)
    fun verifyLineageAndFetchCreatedReportFiles(
        previousStepReport: Report,
        expectedRootReport: Report,
        txn: DataAccessTransaction,
        expectedNumberOfItems: Int,
    ): List<ReportFile> {
        val reportService = ReportService(ReportGraph(ReportStreamTestDatabaseContainer.testDatabaseAccess))

        val itemLineages = DSL
            .using(txn)
            .select(ItemLineage.ITEM_LINEAGE.asterisk())
            .from(ItemLineage.ITEM_LINEAGE)
            .where(ItemLineage.ITEM_LINEAGE.PARENT_REPORT_ID.eq(previousStepReport.id))
            .fetchInto(gov.cdc.prime.router.azure.db.tables.pojos.ItemLineage::class.java)
        assertThat(itemLineages).hasSize(expectedNumberOfItems)
        assertThat(itemLineages.map { it.childIndex }).isEqualTo(MutableList(expectedNumberOfItems) { 1 })

        // if the previousStepReport had multiple items, then the parent indexes will be a list of numbers
        // starting at "1" and ascending by one for every item. if the previousStepReport had one item but
        // that item goes to multiple places then the parent index will always be "1".
        // for example - the result of the "convert" step will fall into the if block. The result of a "route"
        // step will fall into the "else" block because the preceding "convert" step will always create
        // reports with one and only one item to be routed.
        if (previousStepReport.itemCount > 1) {
            assertThat(itemLineages.map { it.parentIndex }).isEqualTo((1..expectedNumberOfItems).toList())
        } else {
            assertThat(itemLineages.map { it.parentIndex }).isEqualTo(MutableList(expectedNumberOfItems) { 1 })
        }

        val reportLineages = DSL
            .using(txn)
            .select(ReportLineage.REPORT_LINEAGE.asterisk())
            .from(ReportLineage.REPORT_LINEAGE)
            .where(ReportLineage.REPORT_LINEAGE.PARENT_REPORT_ID.eq(previousStepReport.id))
            .fetchInto(gov.cdc.prime.router.azure.db.tables.pojos.ReportLineage::class.java)
        assertThat(reportLineages).hasSize(expectedNumberOfItems)
        val childReportIds = reportLineages.map {
            it.childReportId
        }
        val reportFiles = DSL
            .using(txn)
            .select(gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE.asterisk())
            .from(gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE)
            .where(
                gov.cdc.prime.router.azure.db.tables.ReportFile.REPORT_FILE.REPORT_ID.`in`(
                    childReportIds
                )
            )
            .fetchInto(ReportFile::class.java)
        assertThat(reportFiles).hasSize(expectedNumberOfItems)
        assertThat(itemLineages).transform { lineages -> lineages.map { it.childReportId }.sorted() }
            .isEqualTo(reportFiles.map { it.reportId }.sorted())
        childReportIds.forEach {
            val rootReport = reportService.getRootReport(it)
            assertThat(rootReport.reportId).isEqualTo(expectedRootReport.id)
        }

        return reportFiles
    }

    data class ReceiverSetupData(
        val name: String,
        val orgName: String = "phd",
        val topic: Topic = Topic.FULL_ELR,
        val jurisdictionalFilter: List<String> = emptyList(),
        val qualityFilter: List<String> = emptyList(),
        val routingFilter: List<String> = emptyList(),
        val processingModeFilter: List<String> = emptyList(),
        val conditionFilter: List<String> = emptyList(),
        val mappedConditionFilter: ReportStreamConditionFilter = emptyList(),
        val status: CustomerStatus = CustomerStatus.ACTIVE,
        val format: MimeFormat = MimeFormat.CSV,
    )

    fun createReceivers(receiverSetupDataList: List<ReceiverSetupData>): List<Receiver> {
        return receiverSetupDataList.map {
            Receiver(
                it.name,
                it.orgName,
                it.topic,
                it.status,
                "classpath:/metadata/hl7_mapping/ORU_R01/ORU_R01-base.yml",
                timing = Receiver.Timing(numberPerDay = 1, maxReportCount = 1, whenEmpty = Receiver.WhenEmpty()),
                jurisdictionalFilter = it.jurisdictionalFilter,
                qualityFilter = it.qualityFilter,
                routingFilter = it.routingFilter,
                processingModeFilter = it.processingModeFilter,
                conditionFilter = it.conditionFilter,
                mappedConditionFilter = it.mappedConditionFilter,
                format = it.format
            )
        }
    }

    fun createOrganizationWithReceivers(receiverList: List<Receiver>): DeepOrganization {
        return DeepOrganization(
            "phd",
            "test",
            Organization.Jurisdiction.FEDERAL,
            senders = listOf(
                hl7Sender,
                fhirSender,
                hl7SenderWithNoTransform,
                fhirSenderWithNoTransform,
                senderWithValidation
            ),
            receivers = receiverList
        )
    }

    fun createFHIRFunctionsInstance(): FHIRFunctions {
        val settings = FileSettings().loadOrganizations(universalPipelineOrganization)
        val metadata = UnitTestUtils.simpleMetadata
        metadata.lookupTableStore += mapOf(
            "observation-mapping" to LookupTable("observation-mapping", emptyList())
        )
        val workflowEngine = WorkflowEngine.Builder()
            .metadata(metadata)
            .settingsProvider(settings)
            .databaseAccess(ReportStreamTestDatabaseContainer.testDatabaseAccess)
            .build()
        return FHIRFunctions(workflowEngine, databaseAccess = ReportStreamTestDatabaseContainer.testDatabaseAccess)
    }

    fun getBlobContainerMetadata(azuriteContainer: GenericContainer<*>): BlobAccess.BlobContainerMetadata {
        val blobConnectionString =
            """DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=keydevstoreaccount1;
                    BlobEndpoint=http://${azuriteContainer.host}:${

                azuriteContainer.getMappedPort(
                    10000
                )
            }/devstoreaccount1;QueueEndpoint=http://${azuriteContainer.host}:${
                azuriteContainer.getMappedPort(
                    10001
                )
            }/devstoreaccount1;"""
        return BlobAccess.BlobContainerMetadata(
            "container1",
            blobConnectionString
        )
    }

    fun createReport(
        reportContents: String,
        action: TaskAction,
        event: Event.EventAction,
        azuriteContainer: GenericContainer<*>,
        previousAction: TaskAction = TaskAction.receive,
        parentReport: Report? = null,
    ): Report {
        val blobUrl = BlobAccess.uploadBlob(
            "${TaskAction.receive.literal}/mr_fhir_face.fhir",
            reportContents.toByteArray(),
            getBlobContainerMetadata(azuriteContainer)
        )

        return createReport(
            MimeFormat.FHIR,
            previousAction,
            action,
            event,
            Topic.FULL_ELR,
            parentReport,
            blobUrl
        )
    }

    fun createReport(
        fileFormat: MimeFormat,
        currentAction: TaskAction,
        nextAction: TaskAction,
        nextEventAction: Event.EventAction,
        topic: Topic,
        parentReport: Report? = null,
        bodyURL: String? = null,
    ): Report {
        val report = Report(
            fileFormat,
            listOf(
                ClientSource(
                    organization = universalPipelineOrganization.name,
                    client = "Test Sender"
                )
            ),
            1,
            metadata = UnitTestUtils.simpleMetadata,
            nextAction = nextAction,
            topic = topic
        )
        ReportStreamTestDatabaseContainer.testDatabaseAccess.transact { txn ->
            val action = Action().setActionName(currentAction)
            val actionId = ReportStreamTestDatabaseContainer.testDatabaseAccess.insertAction(txn, action)
            report.bodyURL = bodyURL ?: "http://${report.id}.${fileFormat.toString().lowercase()}"

            val reportFile = ReportFile().setSchemaTopic(topic)
                .setReportId(report.id)
                .setActionId(actionId)
                .setSchemaName("")
                .setBodyFormat(fileFormat.toString())
                .setItemCount(1)
                .setExternalName("test-external-name")
                .setBodyUrl(report.bodyURL)
                .setSendingOrg(universalPipelineOrganization.name)
                .setSendingOrgClient("Test Sender")

            ReportStreamTestDatabaseContainer.testDatabaseAccess.insertReportFile(
                reportFile, txn, action
            )
            if (parentReport != null) {
                ReportStreamTestDatabaseContainer.testDatabaseAccess
                    .insertReportLineage(
                        gov.cdc.prime.router.azure.db.tables.pojos.ReportLineage(
                            null,
                            actionId,
                            parentReport.id,
                            report.id,
                            OffsetDateTime.now()
                        ),
                        txn
                    )
            }

            ReportStreamTestDatabaseContainer.testDatabaseAccess.insertTask(
                report,
                fileFormat.toString().lowercase(),
                report.bodyURL,
                nextAction = ProcessEvent(
                    nextEventAction,
                    report.id,
                    Options.None,
                    emptyMap(),
                    emptyList()
                ),
                txn
            )
        }

        return report
    }

    /**
     * check the action table for a list of [expectedTaskActions]
     */
    fun checkActionTable(expectedTaskActions: List<TaskAction>) {
        ReportStreamTestDatabaseContainer.testDatabaseAccess.transact { txn ->
            val actionRecords = DSL.using(txn)
                .select(Tables.ACTION.asterisk())
                .from(Tables.ACTION)
                .fetchInto(
                    Action::class.java
                )

            for (i in 0 until actionRecords.size) {
                assertThat(expectedTaskActions[i]).isEqualTo(actionRecords[i].actionName)
            }
        }
    }
}